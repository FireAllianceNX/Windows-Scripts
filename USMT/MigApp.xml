<?xml version="1.0" encoding="UTF-8"?>
<migration urlid="http://www.microsoft.com/migration/1.0/migxmlext/migapp">

  <library prefix="MigSysHelper">MigSys.dll</library>

  <_locDefinition>
    <_locDefault _loc="locNone"/>
    <_locTag _loc="locData">displayName</_locTag>
  </_locDefinition>

  <namedElements>
    <!-- Global -->
    <environment name="GlobalEnvX64">
      <conditions>
        <condition>MigXmlHelper.IsNative64Bit()</condition>
      </conditions>
      <variable name="HklmWowSoftware">
        <text>HKLM\SOFTWARE\Wow6432Node</text>
      </variable>
      <variable name="ProgramFiles32bit">
        <text>%ProgramFiles(x86)%</text>
      </variable>
      <variable name="CommonProgramFiles32bit">
        <text>%CommonProgramFiles(x86)%</text>
      </variable>
    </environment>
    <environment name="GlobalEnv">
      <conditions>
        <condition negation="Yes">MigXmlHelper.IsNative64Bit()</condition>
      </conditions>
      <variable name="HklmWowSoftware">
        <text>HKLM\Software</text>
      </variable>
      <variable name="ProgramFiles32bit">
        <text>%ProgramFiles%</text>
      </variable>
      <variable name="CommonProgramFiles32bit">
        <text>%CommonProgramFiles%</text>
      </variable>
    </environment>

    <!-- Global USER -->
    <environment context="User" name="GlobalEnvX64User">
      <conditions>
        <condition>MigXmlHelper.IsNative64Bit()</condition>
      </conditions>
      <variable name="VirtualStore_ProgramFiles32bit">
        <text>%CSIDL_VIRTUALSTORE_PROGRAMFILES(X86)%</text>
      </variable>
      <variable name="VirtualStore_CommonProgramFiles32bit">
        <text>%CSIDL_VIRTUALSTORE_COMMONPROGRAMFILES(X86)%</text>
      </variable>
    </environment>
    <environment context="User" name="GlobalEnvUser">
      <conditions>
        <condition negation="Yes">MigXmlHelper.IsNative64Bit()</condition>
      </conditions>
      <variable name="VirtualStore_ProgramFiles32bit">
        <text>%CSIDL_VIRTUALSTORE_PROGRAMFILES%</text>
      </variable>
      <variable name="VirtualStore_CommonProgramFiles32bit">
        <text>%CSIDL_VIRTUALSTORE_COMMONPROGRAMFILES%</text>
      </variable>
    </environment>

    <!-- Firefox detects -->
    <detection name="Firefox">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Mozilla\Mozilla Firefox *.*\bin [PathToExe]")</condition>
      </conditions>
    </detection>
    <detection name="Firefox_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Mozilla\Mozilla Firefox *.*\bin [PathToExe]")</condition>
      </conditions>
    </detection>

    <!-- Google Chrome detects -->
    <detection name="Chrome_User">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKCU\SOFTWARE\Wow6432Node\Google\Update\ClientState\{8A69D345-D564-463c-AFF1-A69D9E530F96}")</condition>
      </conditions>
    </detection>
    <detection name="Chrome_x64User">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKCU\SOFTWARE\Google\Update\ClientState\{8A69D345-D564-463c-AFF1-A69D9E530F96}")</condition>
      </conditions>
    </detection>
    <detection name="Chrome">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\SOFTWARE\Wow6432Node\Google\Update\ClientState\{8A69D345-D564-463c-AFF1-A69D9E530F96}")</condition>
      </conditions>
    </detection>
    <detection name="Chrome_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\SOFTWARE\Google\Update\ClientState\{8A69D345-D564-463c-AFF1-A69D9E530F96}")</condition>
      </conditions>
    </detection>


    <!-- Office paths -->
    <environment name="COMMONOFFICEENV">
      <variable name="OFFICEINSTALLPATH">
        <script>MigXmlHelper.GetStringContent("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\Common\InstallRoot [Path]")</script>
      </variable>
      <variable name="FRONTPAGEEXE">
        <text>%OFFICEINSTALLPATH%\FrontPg.exe</text>
      </variable>
    </environment>

    <!-- Office x86 detects -->
    <detection name="Word">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\Word\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Access">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\Access\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Excel">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\Excel\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="PowerPoint">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\PowerPoint\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Outlook">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\Outlook\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Publisher">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\Publisher\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="FrontPage">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\FrontPage\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Visio">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\Visio [CurrentlyRegisteredVersion]")</condition>
      </conditions>
    </detection>
    <detection name="Visio15">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\Visio\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Visio16">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\Visio\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Project2003">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\MS Project")</condition>
      </conditions>
    </detection>
    <detection name="Project2007">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\Project\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Project14">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\Project\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Project15">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\Project\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Project16">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\Project\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="OneNote">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\OneNote\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="InfoPath">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\InfoPath\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="SharePointDesigner">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\SharePoint Designer\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Lync15">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\Lync\InstallRoot  [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Lync16">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HklmWowSoftware%\Microsoft\Office\%OFFICEVERSION%\Lync\InstallRoot  [Path]")</condition>
      </conditions>
    </detection>

    <!-- Office x64 detects -->
    <detection name="Word_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\Word\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Word_x32_64OS">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\SOFTWARE\Wow6432Node\Microsoft\Office\%OFFICEVERSION%\Word\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Access_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\Access\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Excel_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\Excel\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="PowerPoint_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\PowerPoint\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Outlook_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\Outlook\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Publisher_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\Publisher\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Visio_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\Visio [CurrentlyRegisteredVersion]")</condition>
      </conditions>
    </detection>
    <detection name="Visio15_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\Visio\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Visio16_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\Visio\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Project14_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\Project\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Project15_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\Project\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Project16_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\Project\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="OneNote_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\OneNote\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="InfoPath_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\InfoPath\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="SharePointDesigner_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\SharePoint Designer\InstallRoot [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Lync15_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\Lync\InstallRoot  [Path]")</condition>
      </conditions>
    </detection>
    <detection name="Lync16_x64">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Office\%OFFICEVERSION%\Lync\InstallRoot  [Path]")</condition>
      </conditions>
    </detection>

    <!-- Office SmartTags detects -->
    <detection name="MicrosoftOutlookEmailRecipientsSmartTags">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{4FFB3E8B-AE75-48F2-BF13-D0D7E93FA8F9}")</condition>
      </conditions>
    </detection>
    <detection name="MicrosoftListsSmartTags2003">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{64AB6C69-B40E-40AF-9B7F-F5687B48E2B6}")</condition>
      </conditions>
    </detection>
    <detection name="MicrosoftListsSmartTags2007">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{64AB6C69-B40E-40AF-9B7F-F5687B48E2B6}")</condition>
      </conditions>
    </detection>
    <detection name="MicrosoftListsSmartTags14">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{64AB6C69-B40E-40AF-9B7F-F5687B48E2B6}")</condition>
      </conditions>
    </detection>
    <detection name="MicrosoftListsSmartTags15">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{64AB6C69-B40E-40AF-9B7F-F5687B48E2B6}")</condition>
      </conditions>
    </detection>
    <detection name="MicrosoftListsSmartTags16">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{64AB6C69-B40E-40AF-9B7F-F5687B48E2B6}")</condition>
      </conditions>
    </detection>
    <detection name="MicrosoftPlaceSmartTags">
      <conditions>
        <condition>MigXmlHelper.DoesObjectExist("Registry","HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{87EF1CFE-51CA-4E6B-8C76-E576AA926888}")</condition>
      </conditions>
    </detection>

    <!-- Office 2007 to Office 2010 x86 Settings Upgrade Rule -->
    <rules name="Office2007to14SettingsUpgrade" context="System">
      <include>
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]</pattern>
        </objectSet>
      </include>
      <addObjects>
        <object>
          <location type="Registry">%HklmWowSoftware%\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</location>
          <attributes>DWORD</attributes>
          <bytes>0C000000</bytes>
        </object>
        <object>
          <location type="Registry">%HklmWowSoftware%\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [Lang]</location>
          <attributes>DWORD</attributes>
          <bytes>00000000</bytes>
        </object>
      </addObjects>
      <contentModify script="MigSysHelper.ConvertToOfficeLangID('Registry','HKCU\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]','HKLM\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]')">
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </contentModify>
      <locationModify script="MigXmlHelper.RelativeMove('%HklmWowSoftware%','%HklmWowSoftware%')">
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </locationModify>
    </rules>

    <!-- Office 2007 to Office 2010 x64 Settings Upgrade Rule -->
    <rules name="Office2007to14SettingsUpgrade_x64" context="System">
      <include>
        <objectSet>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]</pattern>
        </objectSet>
      </include>
      <addObjects>
        <object>
          <location type="Registry">HKLM\Software\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</location>
          <attributes>DWORD</attributes>
          <bytes>0C000000</bytes>
        </object>
        <object>
          <location type="Registry">HKLM\Software\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [Lang]</location>
          <attributes>DWORD</attributes>
          <bytes>00000000</bytes>
        </object>
      </addObjects>
      <contentModify script="MigSysHelper.ConvertToOfficeLangID('Registry','HKCU\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]','HKLM\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]')">
        <objectSet>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </contentModify>
    </rules>

    <!-- Office 2007 to Office 15 x86 Settings Upgrade Rule -->
    <rules name="Office2007to15SettingsUpgrade" context="System">
      <include>
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]</pattern>
        </objectSet>
      </include>
      <addObjects>
        <object>
          <location type="Registry">%HklmWowSoftware%\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</location>
          <attributes>DWORD</attributes>
          <bytes>0C000000</bytes>
        </object>
        <object>
          <location type="Registry">%HklmWowSoftware%\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [Lang]</location>
          <attributes>DWORD</attributes>
          <bytes>00000000</bytes>
        </object>
      </addObjects>
      <contentModify script="MigSysHelper.ConvertToOfficeLangID('Registry','HKCU\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]','HKLM\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]')">
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </contentModify>
      <locationModify script="MigXmlHelper.RelativeMove('%HklmWowSoftware%','%HklmWowSoftware%')">
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </locationModify>
    </rules>

    <!-- Office 2007 to Office 15 x64 Settings Upgrade Rule -->
    <rules name="Office2007to15SettingsUpgrade_x64" context="System">
      <include>
        <objectSet>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]</pattern>
        </objectSet>
      </include>
      <addObjects>
        <object>
          <location type="Registry">HKLM\Software\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</location>
          <attributes>DWORD</attributes>
          <bytes>0C000000</bytes>
        </object>
        <object>
          <location type="Registry">HKLM\Software\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [Lang]</location>
          <attributes>DWORD</attributes>
          <bytes>00000000</bytes>
        </object>
      </addObjects>
      <contentModify script="MigSysHelper.ConvertToOfficeLangID('Registry','HKCU\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]','HKLM\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]')">
        <objectSet>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </contentModify>
    </rules>


    <!-- Office 2007 to Office 16 x86 Settings Upgrade Rule -->
    <rules name="Office2007to16SettingsUpgrade" context="System">
      <include>
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]</pattern>
        </objectSet>
      </include>
      <addObjects>
        <object>
          <location type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</location>
          <attributes>DWORD</attributes>
          <bytes>0C000000</bytes>
        </object>
        <object>
          <location type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</location>
          <attributes>DWORD</attributes>
          <bytes>00000000</bytes>
        </object>
      </addObjects>
      <contentModify script="MigSysHelper.ConvertToOfficeLangID('Registry','HKCU\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]','HKLM\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]')">
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </contentModify>
      <locationModify script="MigXmlHelper.RelativeMove('%HklmWowSoftware%','%HklmWowSoftware%')">
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </locationModify>
    </rules>

    <!-- Office 2007 to Office 16 x64 Settings Upgrade Rule -->
    <rules name="Office2007to16SettingsUpgrade_x64" context="System">
      <include>
        <objectSet>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]</pattern>
        </objectSet>
      </include>
      <addObjects>
        <object>
          <location type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</location>
          <attributes>DWORD</attributes>
          <bytes>0C000000</bytes>
        </object>
        <object>
          <location type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</location>
          <attributes>DWORD</attributes>
          <bytes>00000000</bytes>
        </object>
      </addObjects>
      <contentModify script="MigSysHelper.ConvertToOfficeLangID('Registry','HKCU\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]','HKLM\Software\Microsoft\Office\12.0\Common\LanguageResources [SKULanguage]')">
        <objectSet>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </contentModify>
    </rules>

    <!-- Office 2010 to Office 16 x86 Settings Upgrade Rule -->
    <rules name="Office14to16SettingsUpgrade" context="System">
      <include>
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\14.0\Common\LanguageResources [SKULanguage]</pattern>
        </objectSet>
      </include>
      <addObjects>
        <object>
          <location type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</location>
          <attributes>DWORD</attributes>
          <bytes>0C000000</bytes>
        </object>
        <object>
          <location type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</location>
          <attributes>DWORD</attributes>
          <bytes>00000000</bytes>
        </object>
      </addObjects>
      <contentModify script="MigSysHelper.ConvertToOfficeLangID('Registry','HKCU\Software\Microsoft\Office\14.0\Common\LanguageResources [SKULanguage]','HKLM\Software\Microsoft\Office\14.0\Common\LanguageResources [SKULanguage]')">
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </contentModify>
      <locationModify script="MigXmlHelper.RelativeMove('%HklmWowSoftware%','%HklmWowSoftware%')">
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </locationModify>
    </rules>

    <!-- Office 2010 to Office 16 x64 Settings Upgrade Rule -->
    <rules name="Office14to16SettingsUpgrade_x64" context="System">
      <include>
        <objectSet>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\14.0\Common\LanguageResources [SKULanguage]</pattern>
        </objectSet>
      </include>
      <addObjects>
        <object>
          <location type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</location>
          <attributes>DWORD</attributes>
          <bytes>0C000000</bytes>
        </object>
        <object>
          <location type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</location>
          <attributes>DWORD</attributes>
          <bytes>00000000</bytes>
        </object>
      </addObjects>
      <contentModify script="MigSysHelper.ConvertToOfficeLangID('Registry','HKCU\Software\Microsoft\Office\14.0\Common\LanguageResources [SKULanguage]','HKLM\Software\Microsoft\Office\14.0\Common\LanguageResources [SKULanguage]')">
        <objectSet>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </contentModify>
    </rules>

    <!-- Office 2010 to Office 2010 x86 Settings Upgrade Rule -->
    <rules name="Office14to14SettingsMigrate" context="System">
      <include>
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\14.0\Common\LanguageResources [SKULanguage]</pattern>
        </objectSet>
      </include>
      <addObjects>
        <object>
          <location type="Registry">%HklmWowSoftware%\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</location>
          <attributes>DWORD</attributes>
          <bytes>0E000000</bytes>
        </object>
        <object>
          <location type="Registry">%HklmWowSoftware%\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [Lang]</location>
          <attributes>DWORD</attributes>
          <bytes>00000000</bytes>
        </object>
      </addObjects>
      <contentModify script="MigSysHelper.ConvertToOfficeLangID('Registry','HKCU\Software\Microsoft\Office\14.0\Common\LanguageResources [SKULanguage]','HKLM\Software\Microsoft\Office\14.0\Common\LanguageResources [SKULanguage]')">
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </contentModify>
      <locationModify script="MigXmlHelper.RelativeMove('%HklmWowSoftware%','%HklmWowSoftware%')">
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </locationModify>
    </rules>

    <!-- Office 2010 to Office 2010 x64 Settings Upgrade Rule -->
    <rules name="Office14to14SettingsMigrate_x64" context="System">
      <include>
        <objectSet>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\14.0\Common\LanguageResources [SKULanguage]</pattern>
        </objectSet>
      </include>
      <addObjects>
        <object>
          <location type="Registry">HKLM\Software\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</location>
          <attributes>DWORD</attributes>
          <bytes>0E000000</bytes>
        </object>
        <object>
          <location type="Registry">HKLM\Software\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [Lang]</location>
          <attributes>DWORD</attributes>
          <bytes>00000000</bytes>
        </object>
      </addObjects>
      <contentModify script="MigSysHelper.ConvertToOfficeLangID('Registry','HKCU\Software\Microsoft\Office\14.0\Common\LanguageResources [SKULanguage]','HKLM\Software\Microsoft\Office\14.0\Common\LanguageResources [SKULanguage]')">
        <objectSet>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\14.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </contentModify>
    </rules>

    <!-- Office 15 to Office 15 x86 Settings Upgrade Rule -->
    <rules name="Office15to15SettingsMigrate" context="System">
      <include>
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\15.0\Common\LanguageResources [SKULanguage]</pattern>
        </objectSet>
      </include>
      <addObjects>
        <object>
          <location type="Registry">%HklmWowSoftware%\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</location>
          <attributes>DWORD</attributes>
          <bytes>0E000000</bytes>
        </object>
        <object>
          <location type="Registry">%HklmWowSoftware%\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [Lang]</location>
          <attributes>DWORD</attributes>
          <bytes>00000000</bytes>
        </object>
      </addObjects>
      <contentModify script="MigSysHelper.ConvertToOfficeLangID('Registry','HKCU\Software\Microsoft\Office\15.0\Common\LanguageResources [SKULanguage]','HKLM\Software\Microsoft\Office\15.0\Common\LanguageResources [SKULanguage]')">
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </contentModify>
      <locationModify script="MigXmlHelper.RelativeMove('%HklmWowSoftware%','%HklmWowSoftware%')">
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </locationModify>
    </rules>

    <!-- Office 15 to Office 15 x64 Settings Upgrade Rule -->
    <rules name="Office15to15SettingsMigrate_x64" context="System">
      <include>
        <objectSet>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\15.0\Common\LanguageResources [SKULanguage]</pattern>
        </objectSet>
      </include>
      <addObjects>
        <object>
          <location type="Registry">HKLM\Software\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</location>
          <attributes>DWORD</attributes>
          <bytes>0E000000</bytes>
        </object>
        <object>
          <location type="Registry">HKLM\Software\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [Lang]</location>
          <attributes>DWORD</attributes>
          <bytes>00000000</bytes>
        </object>
      </addObjects>
      <contentModify script="MigSysHelper.ConvertToOfficeLangID('Registry','HKCU\Software\Microsoft\Office\15.0\Common\LanguageResources [SKULanguage]','HKLM\Software\Microsoft\Office\15.0\Common\LanguageResources [SKULanguage]')">
        <objectSet>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\15.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </contentModify>
    </rules>

    <!-- Office 15 to Office 16 x86 Settings Upgrade Rule -->
    <rules name="Office15to16SettingsUpgrade" context="System">
      <include>
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\15.0\Common\LanguageResources [SKULanguage]</pattern>
        </objectSet>
      </include>
      <addObjects>
        <object>
          <location type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</location>
          <attributes>DWORD</attributes>
          <bytes>0C000000</bytes>
        </object>
        <object>
          <location type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</location>
          <attributes>DWORD</attributes>
          <bytes>00000000</bytes>
        </object>
      </addObjects>
      <contentModify script="MigSysHelper.ConvertToOfficeLangID('Registry','HKCU\Software\Microsoft\Office\15.0\Common\LanguageResources [SKULanguage]','HKLM\Software\Microsoft\Office\14.0\Common\LanguageResources [SKULanguage]')">
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </contentModify>
      <locationModify script="MigXmlHelper.RelativeMove('%HklmWowSoftware%','%HklmWowSoftware%')">
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </locationModify>
    </rules>

    <!-- Office 15 to Office 16 x64 Settings Upgrade Rule -->
    <rules name="Office15to16SettingsUpgrade_x64" context="System">
      <include>
        <objectSet>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\15.0\Common\LanguageResources [SKULanguage]</pattern>
        </objectSet>
      </include>
      <addObjects>
        <object>
          <location type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</location>
          <attributes>DWORD</attributes>
          <bytes>0C000000</bytes>
        </object>
        <object>
          <location type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</location>
          <attributes>DWORD</attributes>
          <bytes>00000000</bytes>
        </object>
      </addObjects>
      <contentModify script="MigSysHelper.ConvertToOfficeLangID('Registry','HKCU\Software\Microsoft\Office\15.0\Common\LanguageResources [SKULanguage]','HKLM\Software\Microsoft\Office\14.0\Common\LanguageResources [SKULanguage]')">
        <objectSet>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </contentModify>
    </rules>

    <!-- Office 16 to Office 16 x86 Settings Upgrade Rule -->
    <rules name="Office16to16SettingsMigrate" context="System">
      <include>
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\LanguageResources [SKULanguage]</pattern>
        </objectSet>
      </include>
      <addObjects>
        <object>
          <location type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</location>
          <attributes>DWORD</attributes>
          <bytes>0E000000</bytes>
        </object>
        <object>
          <location type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</location>
          <attributes>DWORD</attributes>
          <bytes>00000000</bytes>
        </object>
      </addObjects>
      <contentModify script="MigSysHelper.ConvertToOfficeLangID('Registry','HKCU\Software\Microsoft\Office\16.0\Common\LanguageResources [SKULanguage]','HKLM\Software\Microsoft\Office\15.0\Common\LanguageResources [SKULanguage]')">
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </contentModify>
      <locationModify script="MigXmlHelper.RelativeMove('%HklmWowSoftware%','%HklmWowSoftware%')">
        <objectSet>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </locationModify>
    </rules>

    <!-- Office 16 to Office 16 x64 Settings Upgrade Rule -->
    <rules name="Office16to16SettingsMigrate_x64" context="System">
      <include>
        <objectSet>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\LanguageResources [SKULanguage]</pattern>
        </objectSet>
      </include>
      <addObjects>
        <object>
          <location type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [UpgradeVersion]</location>
          <attributes>DWORD</attributes>
          <bytes>0E000000</bytes>
        </object>
        <object>
          <location type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</location>
          <attributes>DWORD</attributes>
          <bytes>00000000</bytes>
        </object>
      </addObjects>
      <contentModify script="MigSysHelper.ConvertToOfficeLangID('Registry','HKCU\Software\Microsoft\Office\15.0\Common\LanguageResources [SKULanguage]','HKLM\Software\Microsoft\Office\15.0\Common\LanguageResources [SKULanguage]')">
        <objectSet>
          <pattern type="Registry">HKLM\Software\Microsoft\Office\16.0\Common\Migration\%OFFICEPROGRAM% [Lang]</pattern>
        </objectSet>
      </contentModify>
    </rules>


    <!-- Outlook Pst Rule -->
    <rules name="OutlookPstPab" context="User">
      <include>
        <objectSet>
          <pattern type="Registry">%OUTLOOKPROFILESPATH%* [01020fff]</pattern>
          <pattern type="Registry">%OUTLOOKPROFILESPATH%* [001e0324]</pattern>
          <pattern type="Registry">%OUTLOOKPROFILESPATH%* [001e6600]</pattern>
          <pattern type="Registry">%OUTLOOKPROFILESPATH%* [001e6700]</pattern>
          <content filter="MigSysHelper.ExtractSingleFileAnsiBin()">
            <objectSet>
              <pattern type="Registry">%OUTLOOKPROFILESPATH%* [001e0324]</pattern>
              <pattern type="Registry">%OUTLOOKPROFILESPATH%* [001e6600]</pattern>
              <pattern type="Registry">%OUTLOOKPROFILESPATH%* [001e6700]</pattern>
            </objectSet>
          </content>
        </objectSet>
      </include>

      <include>
        <objectSet>
          <pattern type="Registry">%OUTLOOKPROFILESPATH%* [001f0324]</pattern>
          <pattern type="Registry">%OUTLOOKPROFILESPATH%* [001f6600]</pattern>
          <pattern type="Registry">%OUTLOOKPROFILESPATH%* [001f6700]</pattern>
          <content filter="MigSysHelper.ExtractSingleFileUnicodeBin()">
            <objectSet>
              <pattern type="Registry">%OUTLOOKPROFILESPATH%* [001e0324]</pattern>
              <pattern type="Registry">%OUTLOOKPROFILESPATH%* [001e6600]</pattern>
              <pattern type="Registry">%OUTLOOKPROFILESPATH%* [001e6700]</pattern>
              <pattern type="Registry">%OUTLOOKPROFILESPATH%* [001f0324]</pattern>
              <pattern type="Registry">%OUTLOOKPROFILESPATH%* [001f6600]</pattern>
              <pattern type="Registry">%OUTLOOKPROFILESPATH%* [001f6700]</pattern>
            </objectSet>
          </content>
        </objectSet>
      </include>

      <contentModify script='MigSysHelper.SetPstPathInMapiStruct ()'>
        <objectSet>
          <pattern type="Registry">%OUTLOOKPROFILESPATH%* [0102*]</pattern>
        </objectSet>
      </contentModify>

      <contentModify script='MigSysHelper.UpdateMvBinaryMapiStruct ()'>
        <objectSet>
          <pattern type="Registry">%OUTLOOKPROFILESPATH%* [0102*]</pattern>
        </objectSet>
      </contentModify>

      <contentModify script='MigSysHelper.UpdateMvBinaryMapiStruct ()'>
        <objectSet>
          <pattern type="Registry">%OUTLOOKPROFILESPATH%* [1102*]</pattern>
        </objectSet>
      </contentModify>
    </rules>

  </namedElements>

  <!-- iTunes (7 and up) -->
  <component context="UserAndSystem" type="Application">
    <displayName _locID="migapp.iTunes">iTunes</displayName>
    <environment name="GlobalEnv"/>
    <environment name="GlobalEnvX64"/>
    <environment>
      <variable name="iTunesExe">
        <script>MigXmlHelper.GetStringContent("Registry","%HklmWowSoftware%\Microsoft\Windows\CurrentVersion\App Paths\iTunes.exe []")</script>
      </variable>
    </environment>
    <role role="Settings">
      <detects>
        <detect>
          <condition>MigXmlHelper.DoesFileVersionMatch("%iTunesExe%","ProductVersion","7.*")</condition>
          <condition>MigXmlHelper.DoesFileVersionMatch("%iTunesExe%","ProductVersion","8.*")</condition>
          <condition>MigXmlHelper.DoesFileVersionMatch("%iTunesExe%","ProductVersion","9.*")</condition>
          <condition>MigXmlHelper.DoesFileVersionMatch("%iTunesExe%","ProductVersion","10.*")</condition>
          <condition>MigXmlHelper.DoesFileVersionMatch("%iTunesExe%","ProductVersion","11.*")</condition>
          <condition>MigXmlHelper.DoesFileVersionMatch("%iTunesExe%","ProductVersion","12.*")</condition>
        </detect>
      </detects>
      <rules context="User">
        <include>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Apple Computer, Inc.\iTunes\* [*]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Apple Computer\iTunes\ [*]</pattern>
            <pattern type="File">%CSIDL_APPDATA%\Apple Computer\iTunes\* [*]</pattern>
          </objectSet>
        </include>
        <merge script="MigXmlHelper.SourcePriority()">
          <objectSet>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Apple Computer\iTunes\ [*]</pattern>
            <pattern type="File">%CSIDL_APPDATA%\Apple Computer\iTunes\* [*]</pattern>
          </objectSet>
        </merge>
      </rules>
    </role>
  </component>

  <!-- Microsoft Office 2007 -->
  <component context="UserAndSystem" type="Application">
    <displayName _locID="migapp.office2007">Microsoft Office 2007</displayName>
    <environment name="GlobalEnv"/>
    <environment name="GlobalEnvX64"/>
    <environment>
      <variable name="OFFICEVERSION">
        <text>12.0</text>
      </variable>
    </environment>
    <role role="Container">
      <detection name="Word"/>
      <detection name="PowerPoint"/>
      <detection name="Access"/>
      <detection name="Excel"/>
      <detection name="Outlook"/>
      <detection name="Publisher"/>
      <detection name="Visio"/>
      <detection name="Project2007"/>
      <detection name="OneNote"/>

      <!-- Office 2007 Common Settings -->
      <component context="UserAndSystem" type="Application" hidden="TRUE">
        <displayName _locID="migapp.office2007common">Office 2007 Common Settings</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Office</text>
          </variable>
        </environment>
        <role role="Settings">
          <!-- For Office 2007 -->
          <rules context="User">
            <!-- From AnyOfficeProduct -->
            <include filter='MigXmlHelper.IgnoreIrrelevantLinks()'>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Shared Tools\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [*.acl]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\Recent [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Templates\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office [*.qat]</pattern>
                <!-- Extract custom dictionaries and related files -->
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Proof\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\UProof\* [*]</pattern>
                <content filter="MigXmlHelper.ExtractSingleFile(NULL, NULL)">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Shared Tools\Proofing Tools\*\Custom Dictionaries [*]</pattern>
                  </objectSet>
                </content>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Shortcut Bar [LocalPath]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Internet [LocationOfComponents]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Open Find\* [*]</pattern>
              </objectSet>
            </exclude>
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Internet\DoNotCheckIfOfficeIsHTMLEditor\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Internet [AllowPNG]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Internet [RelyOnVML]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Internet [SaveNewWebPagesAsWebArchives]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Toolbars [BtnSize]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Toolbars [Tooltips]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Toolbars [AdaptiveMenus]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Toolbars [Animation]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Toolbars [ShowKbdShortcuts]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Toolbars [FontView]</pattern>
              </objectSet>
            </destinationCleanup>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [*.acl]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office [*.qat]</pattern>
                <!-- Custom dictionaries -->
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Proof\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\UProof\* [*]</pattern>
                <content filter="MigXmlHelper.ExtractSingleFile(NULL, NULL)">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Shared Tools\Proofing Tools\*\Custom Dictionaries [*]</pattern>
                  </objectSet>
                </content>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office2007to14SettingsUpgrade" />
          <rules name="Office2007to14SettingsUpgrade_x64" />
          <rules name="Office2007to16SettingsUpgrade" />
          <rules name="Office2007to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office Access 2007 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office2007access">Microsoft Office Access 2007</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Access</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Access"/>
          <rules>
            <!--  copy files -->
            <include>
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [Access11.pip]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Access\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Access\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\CMA\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Toolbars\Settings\ [Microsoft Access]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\Access\File MRU\* [*]</pattern>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Access\Settings [MRU1]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Access\Settings [MRU2]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Access\Settings [MRU3]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Access\Settings [MRU4]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Access\Settings [MRU5]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Access\Settings [MRU6]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Access\Settings [MRUFlags1]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Access\Settings [MRUFlags2]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Access\Settings [MRUFlags3]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Access\Settings [MRUFlags4]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Access\Settings [MRUFlags5]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Access\Settings [MRUFlags6]</pattern>
              </objectSet>
            </exclude>
            <!-- force src -->
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [Access11.pip]</pattern>
              </objectSet>
            </merge>
            <!-- force dest -->
            <merge script="MigXmlHelper.DestinationPriority()">
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Access\Options [Default Database Directory]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office2007to14SettingsUpgrade" />
          <rules name="Office2007to14SettingsUpgrade_x64" />
          <rules name="Office2007to16SettingsUpgrade" />
          <rules name="Office2007to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office Excel 2007 -->
      <component  context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office2007excel">Microsoft Office Excel 2007</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Excel</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Excel"/>
          <rules>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Excel\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Toolbars\Settings\ [Microsoft Excel]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Excel\ [EXCEL11.xlb]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [EXCEL11.pip]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\Excel\File MRU\* [*]</pattern>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Excel\Recent Files\* [*]</pattern>
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.DestinationPriority()">
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Excel\Options\ [AltStartup]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Excel\Options\ [DefaultPath]</pattern>
              </objectSet>
            </merge>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Excel\ [EXCEL11.xlb]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [EXCEL11.pip]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office2007to14SettingsUpgrade" />
          <rules name="Office2007to14SettingsUpgrade_x64" />
          <rules name="Office2007to16SettingsUpgrade" />
          <rules name="Office2007to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office Outlook 2007 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office2007outlook">Microsoft Office Outlook 2007</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Outlook</text>
          </variable>
          <variable name="OUTLOOKPROFILESPATH">
            <text>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows Messaging Subsystem\Profiles\</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Outlook"/>
          <rules name="OutlookPstPab" />
          <rules context="User">
            <!-- addreg -->
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Outlook\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Outlook\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Toolbars\Settings [Microsoft Outlook]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Outlook\OMI Account Manager\Accounts\* [*]</pattern>

                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [*.officeUI]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office [*.officeUI]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Signatures\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Templates\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Stationery\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\FORMS [frmcache.dat]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook [outcmd11.dat]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook [outcmd.dat]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook [views.dat]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook [OutlPrint]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office  [MSOut11.pip]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Exchange\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook [*.rwz]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook [*.srs]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook [*.NK2]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook [*.xml]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows Messaging Subsystem\Profiles\* [*]</pattern>
                <content filter="MigXmlHelper.ExtractSingleFile(NULL,'%CSIDL_LOCAL_APPDATA%\Microsoft\Outlook')">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Outlook\Journal\* [*]</pattern>
                  </objectSet>
                </content>
                <content filter="MigXmlHelper.ExtractSingleFile(NULL, NULL)">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows Messaging Subsystem\Profiles\* [001e023d]</pattern>
                    <pattern type="Registry">HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows Messaging Subsystem\Profiles\* [001f023d]</pattern>
                  </objectSet>
                </content>
              </objectSet>
            </include>
            <!-- delreg -->
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Outlook [FirstRunDialog]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Outlook [Machine Name]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows Messaging Subsystem\Profiles\*\0a0d020000000000c000000000000046 [111f031e]</pattern>
                <pattern type="Registry">HKCU\Identities\* [LDAP Server]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Internet Account Manager\Accounts\* [LDAP Server]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Outlook\OMI Account Manager\Accounts\* [LDAP Server]</pattern>
              </objectSet>
            </exclude>
            <!-- destdelreg -->
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Outlook\OMI Account Manager\Accounts\* [Connection Flags]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Outlook\OMI Account Manager\Accounts\* [Connection Type]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Outlook\OMI Account Manager\Accounts\* [Connectoid]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows Messaging Subsystem\Profiles [DefaultProfile]</pattern>
              </objectSet>
            </destinationCleanup>
            <!-- forcesrcfile -->
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\FORMS [frmcache.dat]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook [outcmd11.dat]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook [outcmd.dat]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook [views.dat]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [MSOut11.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook [*.srs]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook [*.xml]</pattern>
              </objectSet>
            </merge>
            <!-- Outlook ForceDestFile -->
            <merge script="MigXmlHelper.DestinationPriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook [*.rwz]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules context="System">
            <!-- addreg -->
            <include>
              <objectSet>
                <pattern type="Registry">%HklmWowSoftware%\Clients\Mail\Microsoft Outlook [MSIComponentID]</pattern>
                <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\12.0\Outlook\Setup [MailSupport]</pattern>
              </objectSet>
            </include>
            <locationModify script="MigXmlHelper.RelativeMove('%HklmWowSoftware%','%HklmWowSoftware%')">
              <objectSet>
                <pattern type="Registry">%HklmWowSoftware%\Clients\Mail\Microsoft Outlook [MSIComponentID]</pattern>
                <pattern type="Registry">%HklmWowSoftware%\Microsoft\Office\12.0\Outlook\Setup [MailSupport]</pattern>
              </objectSet>
            </locationModify>
          </rules>
          <rules name="Office2007to14SettingsUpgrade" />
          <rules name="Office2007to14SettingsUpgrade_x64" />
          <rules name="Office2007to16SettingsUpgrade" />
          <rules name="Office2007to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office PowerPoint 2007 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office2007powerpoint">Microsoft Office PowerPoint 2007</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Powerpoint</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="PowerPoint"/>
          <rules>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\PowerPoint\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\PowerPoint\RecentFolderList [Default]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Toolbars\Settings [Microsoft PowerPoint]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\PowerPoint [PPT11.pcb]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [PowerP11.pip]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\Powerpoint\File MRU\* [*]</pattern>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\PowerPoint\Recent File List\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\PowerPoint\RecentFolderList\* [*]</pattern>
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.DestinationPriority()">
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\PowerPoint\RecentFolderList [Default]</pattern>
              </objectSet>
            </merge>
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\PowerPoint\Internet [HTMLVersion]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\PowerPoint\Options [AutoKeyboard Switching]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\PowerPoint\Options [BackgroundPrint]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\PowerPoint\Options [DisableNewAnimationUI]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\PowerPoint\Options [DisablePasswordUI]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\PowerPoint\Options [MaxNumberDesigns]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\PowerPoint\Options [Send TrueType fonts as bitmaps]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\PowerPoint\Options [Send printer information to OLE servers]</pattern>
              </objectSet>
            </destinationCleanup>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\PowerPoint [PPT11.pcb]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [PowerP11.pip]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office2007to14SettingsUpgrade" />
          <rules name="Office2007to14SettingsUpgrade_x64" />
          <rules name="Office2007to16SettingsUpgrade" />
          <rules name="Office2007to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office Publisher 2007 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office2007publisher">Microsoft Office Publisher 2007</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Publisher</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Publisher"/>
          <rules>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Publisher\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Toolbars\Settings [Microsoft Publisher]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [*.acl]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [Publis11.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [*.jsp]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [pg_custom.xml]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Publisher [pubcmd.dat]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Publisher [custcols.scm]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Publisher\BusinessInfo\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Publisher\Content Library\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Publisher\Font Schemes\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Publisher Building Blocks\* [*]</pattern>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Publisher\Recent File List\* [*]</pattern>
              </objectSet>
            </exclude>
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Publisher\UserInfo\* [FullName]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Publisher\UserInfo\* [CompanyName]</pattern>
              </objectSet>
            </destinationCleanup>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [*.acl]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Publisher [pubcmd.dat]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [Publis11.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [*.jsp]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Publisher Building Blocks\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office2007to14SettingsUpgrade" />
          <rules name="Office2007to14SettingsUpgrade_x64" />
          <rules name="Office2007to16SettingsUpgrade" />
          <rules name="Office2007to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office Word 2007 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office2007word">Microsoft Office Word 2007</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Word</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Word"/>
          <rules>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Word\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Common\Toolbars\Settings [Microsoft Word]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Templates\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\QuickStyles\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Document Building Blocks\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Bibliography\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [Word11.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [WordMa11.pip]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\Word\File MRU\* [*]</pattern>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Word\Data\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\12.0\Word\Options [PROGRAMDIR]</pattern>
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\QuickStyles\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Templates\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [Word11.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [WordMa11.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Document Building Blocks\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office2007to14SettingsUpgrade" />
          <rules name="Office2007to14SettingsUpgrade_x64" />
          <rules name="Office2007to16SettingsUpgrade" />
          <rules name="Office2007to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office SmartTags -->
      <component context="User" type="Application" hidden="TRUE">
        <displayName _locID="migapp.office2007smarttag">Microsoft Office SmartTags</displayName>
        <role role="Container">
          <detection name="MicrosoftOutlookEmailRecipientsSmartTags" />
          <detection name="MicrosoftListsSmartTags2007" />
          <detection name="MicrosoftPlaceSmartTags" />

          <!-- Microsoft Outlook Email Recipients SmartTags -->
          <component context="User" type="Application">
            <displayName _locID="migapp.office2007emailsmarttag">Microsoft Outlook Email Recipients SmartTags</displayName>
            <role role="Settings">
              <detection name="MicrosoftOutlookEmailRecipientsSmartTags" />
              <rules>
                <include>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{4FFB3E8B-AE75-48F2-BF13-D0D7E93FA8F9}\* [*]</pattern>
                  </objectSet>
                </include>
                <destinationCleanup>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{4FFB3E8B-AE75-48F2-BF13-D0D7E93FA8F9} [*]</pattern>
                  </objectSet>
                </destinationCleanup>
              </rules>
            </role>
          </component>

          <!-- Microsoft Lists SmartTags -->
          <component context="User" type="Application">
            <displayName _locID="migapp.office2007listsmarttag">Microsoft Lists SmartTags</displayName>
            <role role="Settings">
              <detection name="MicrosoftListsSmartTags2007" />
              <rules>
                <include>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{64AB6C69-B40E-40AF-9B7F-F5687B48E2B6}\* [*]</pattern>
                  </objectSet>
                </include>
                <destinationCleanup>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{64AB6C69-B40E-40AF-9B7F-F5687B48E2B6}\* [*]</pattern>
                  </objectSet>
                </destinationCleanup>
              </rules>
            </role>
          </component>

          <!-- Microsoft Place SmartTags -->
          <component context="User" type="Application">
            <displayName _locID="migapp.office2007placesmarttag">Microsoft Place SmartTags</displayName>
            <role role="Settings">
              <detection name="MicrosoftPlaceSmartTags" />
              <rules>
                <include>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{87EF1CFE-51CA-4E6B-8C76-E576AA926888}\* [*]</pattern>
                  </objectSet>
                </include>
                <destinationCleanup>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{87EF1CFE-51CA-4E6B-8C76-E576AA926888} [*]</pattern>
                  </objectSet>
                </destinationCleanup>
              </rules>
            </role>
          </component>

        </role>
      </component>

      <!-- Microsoft Office Visio 2007 -->
      <component type="Application" context="UserAndSystem">
        <displayName _locID="migapp.visio2007">Microsoft Office Visio 2007</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Visio</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Visio" />
          <rules context="User">
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\software\Microsoft\Office\%OFFICEVERSION%\Visio\* [*]</pattern>
                <pattern type="Registry">HKCU\software\Microsoft\Office\%OFFICEVERSION%\Common\Toolbars\Settings\ [Microsoft Office Visio]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [Visio12.pip]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Visio\ [content.dat]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\Visio\Recent Templates\* [*]</pattern>
                <content filter="MigXmlHelper.ExtractSingleFile(NULL,'NULL')">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\Visio\Recent Templates\* [Template*]</pattern>
                  </objectSet>
                </content>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\software\Microsoft\Office\%OFFICEVERSION%\Visio\Application\ [LastFile*]</pattern>
                <pattern type="Registry">HKCU\software\Microsoft\Office\%OFFICEVERSION%\Visio\Application\ [MyShapesPath]</pattern>
                <pattern type="Registry">HKCU\software\Microsoft\Office\%OFFICEVERSION%\Visio\Application\ [UserDictionaryPath1]</pattern>
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [Visio12.pip]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Visio\ [content.dat]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office2007to14SettingsUpgrade" />
          <rules name="Office2007to14SettingsUpgrade_x64" />
          <rules name="Office2007to16SettingsUpgrade" />
          <rules name="Office2007to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Project 2007 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.project2007">Microsoft Project 2007</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Project</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Project2007" />
          <rules>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\MS Project\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\Common\Toolbars\Settings [Microsoft Office Project]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [MSProj12.pip]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\MS Project\Recent Templates\* [*]</pattern>
                <content filter="MigXmlHelper.ExtractSingleFile(NULL,'NULL')">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\MS Project\Recent Templates\* [Template*]</pattern>
                  </objectSet>
                </content>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\MS Project\Recent File List [*]</pattern>
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [MSProj12.pip]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office2007to14SettingsUpgrade" />
          <rules name="Office2007to14SettingsUpgrade_x64" />
          <rules name="Office2007to16SettingsUpgrade" />
          <rules name="Office2007to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office OneNote 2007 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office2007onenote">Microsoft Office OneNote 2007</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>OneNote</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="OneNote"/>
          <rules>
            <destinationCleanup>
              <objectSet>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\OneNote\%OFFICEVERSION%\ [OneNoteOfflineCache.onecache]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\OneNote\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\Common\Toolbars\Settings\ [Microsoft Office OneNote]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [OneNot12.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\OneNote\%OFFICEVERSION%\ [Preferences.dat]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\OneNote\%OFFICEVERSION%\ [Toolbars.dat]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\OneNote\Recent Templates\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\MS Project\12\* [*]</pattern>
                <content filter="MigXmlHelper.ExtractSingleFile(NULL,'NULL')">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\OneNote\Recent Templates\* [Template*]</pattern>
                  </objectSet>
                </content>
              </objectSet>
            </include>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [OneNot12.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\OneNote\%OFFICEVERSION% [Preferences.dat]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\OneNote\%OFFICEVERSION% [Toolbars.dat]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\MS Project\12\* [*]</pattern>
              </objectSet>
            </merge>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\OneNote\General\ [LastMyDocumentsPathUsed]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\%OFFICEVERSION%\OneNote\Options\Paths\ [BackupFolderPath]</pattern>
              </objectSet>
            </exclude>
          </rules>
          <rules name="Office2007to14SettingsUpgrade" />
          <rules name="Office2007to14SettingsUpgrade_x64" />
          <rules name="Office2007to16SettingsUpgrade" />
          <rules name="Office2007to16SettingsUpgrade_x64" />
        </role>
      </component>
    </role>
  </component>

  <!-- WinZip -->
  <component context="User" type="Application">
    <displayName _locID="migapp.winzip">WinZip</displayName>
    <environment>
      <variable name="HklmWowSoftware">
        <text>HKLM\Software</text>
      </variable>
      <variable name="WinZip8or9or10Exe">
        <script>MigXmlHelper.GetStringContent("Registry","%HklmWowSoftware%\Microsoft\Windows\CurrentVersion\App Paths\winzip32.exe []")</script>
      </variable>
    </environment>
    <role role="Settings">
      <detects>
        <detect>
          <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Nico Mak Computing\WinZip\WinIni [win32_version]")</condition>
        </detect>
        <detect>
          <condition>MigXmlHelper.DoesFileVersionMatch("%WinZip8or9or10Exe%","ProductVersion","8.*")</condition>
          <condition>MigXmlHelper.DoesFileVersionMatch("%WinZip8or9or10Exe%","ProductVersion","9.*")</condition>
          <condition>MigXmlHelper.DoesFileVersionMatch("%WinZip8or9or10Exe%","ProductVersion","10.*")</condition>

        </detect>
      </detects>
      <rules>
        <destinationCleanup>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\fm\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\ListView\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\ToolBar\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WIZARD\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\wzshlext\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [Adjustable]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [AltDrag]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [AlwaysOnTop]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [AnimatedBusy]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [AutoOpen]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [Beep]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [CheckOutIconOnly]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [CheckOutScan]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [ExplorerButtons]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [Extract95]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [ExtractSkipOlder]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [FilterIndex]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [GrayButtons]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [IBS]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [LastTip]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [Lower]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [MRUSize]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [QuikviewSeen]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [RecycleBin]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [ReuseWindows]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [Setup]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [ShowTips]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [SpanDefault]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [ViewerFont]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [Wizard]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [256ColorBtn]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [FlatBtns]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [LargeBtn]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [PromptView]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [ShowBtnText]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [ShowComment]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [SmartDoc]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [TarCrLf]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [ThemeInstaller]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [ToolTips]</pattern>
          </objectSet>
        </destinationCleanup>
        <include>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\directories [gzAddDir]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\directories [gzExtractTo]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\directories [zDefDir]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\directories [ZipTempRemovableOnly]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\ListView\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\fm\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\ToolBar\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WIZARD\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\wzshlext\* [*]</pattern>
          </objectSet>
        </include>
        <exclude>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [Display]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [Main]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WinZip [Viewdir]</pattern>
            <pattern type="Registry">HKCU\Software\Nico Mak Computing\WinZip\WIZARD [ExtractTo]</pattern>
          </objectSet>
        </exclude>
      </rules>
    </role>
  </component>

  <!-- Acrobat Reader DC -->
  <component context="UserAndSystem" type="Application">
    <displayName _locID="migapp.adobereader7">Acrobat Reader DC</displayName>
    <environment name="GlobalEnv"/>
    <environment name="GlobalEnvX64"/>

    <environment>
      <variable name="AdobeReaderInstPath">
        <script>MigXmlHelper.GetStringContent("Registry","%HklmWowSoftware%\Adobe\Acrobat Reader\DC\Installer [Path]","0","","\")</script>
      </variable>
    </environment>

    <role role="Settings">
      <detects>
        <detect>
          <condition>MigXmlHelper.DoesObjectExist("Registry","HKCU\Software\Adobe\Acrobat Reader\DC")</condition>
        </detect>
        <detect>
          <condition>MigXmlHelper.DoesFileVersionMatch("%AdobeReaderInstPath%\Reader\AcroRd32.exe","ProductVersion","15.*")</condition>
          <condition>MigXmlHelper.DoesFileVersionMatch("%AdobeReaderInstPath%\Reader\AcroRd32.exe","ProductVersion","17.*")</condition>
        </detect>
      </detects>
      <rules context="User">
        <destinationCleanup>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bCacheFormData]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bFullScreenClick]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bOpenInPlace]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bAllowOpenFile]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bSaveAsLinearized]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bAllowByteRangeRequests]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bBrowserIntegration]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bDownloadEntireFile]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bAntialiasGraphics]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bAntialiasImages]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bAntialiasText]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bShowLargeDIBS]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bUseLogicalPageNumbers]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bDisplayAboutDialog]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bDisplayedSplash]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bEmitPostScriptXObjects]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [benableDDR]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bFullScreenIgnoreTrans]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bGreekText]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bIgnorePageClip]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bOverPrintPreview]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bUsePageCache]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bUseSlideTimer]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bUseSysSetting]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [bWrapSlideShowPages]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [iTrustedMode]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [iDefaultZoomType]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [iDefaultZoomScale]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [iPixelsPerInch]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [iAccessColorPolicy]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [iAntialiasThreshold]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [iPixelsPerInch]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [iDefaultMaxThreadZoom]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Originals [iNoteOpacity]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\DocumentStatus [bDocAttachmentStatus]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\DocumentStatus [bDocCertifiedStatus]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\DocumentStatus [bDocOCGStatus]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\DocumentStatus [bDocSecurityStatus]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\DocumentStatus [bDocSignatureStatus]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\DocumentStatus [bDocUserPropertiesStatus]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\DocumentStatus [bSuppressStatusDialog]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [AccessBackgroundColorBlue]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [AccessBackgroundColorGreen]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [AccessBackgroundColorRed]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [AccessColorPolicy]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [AccessMaxDocModePages]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [AccessOverrideDocColors]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [AccessPageMode]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [AccessTextColorBlue]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [AccessTextColorGreen]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [AccessTextColorRed]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [AllowByteRangeRequests]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [AllowOpenFile]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [AntialiasGraphics]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [AntialiasImages]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [AntialiasThreshold]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [AntialiasText]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [BrowserCheck]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [DisplayAboutDialog]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [DefaultMaxThreadZoom]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [DefaultSlideTimer]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [DefaultZoomScale]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [DefaultZoomType]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [DownloadEntireFile]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [enableDDR]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [FullScreenClick]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [FullScreenColorBlue]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [FullScreenColorGreen]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [FullScreenColorRed]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [FullScreenCursor]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [FullScreenEscape]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [FullScreenTransitionType]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [Gamma]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [GreekText]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [GreekThreshold]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [IgnorePageClip]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [NoteFontName]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [NotePointSize]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [OpenInPlace]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [PageUnits]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [PageViewLayoutMode]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [TransparencyGrid]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [TrustedMode]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [UpdateFrequency]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [UseLogicalPageNumbers]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [UsePageCache]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [UseSlideTimer]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AdobeViewer [WrapSlideShowPages]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\AVGeneral\cToolbars\* [bHidden]</pattern>
          </objectSet>
        </destinationCleanup>
        <include>
          <objectSet>
            <pattern type="File">%CSIDL_APPDATA%\Adobe\Acrobat\DC\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\* [*]</pattern>
          </objectSet>
        </include>
        <exclude>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Adobe\Acrobat Reader\DC\Installer\* [*]</pattern>
            <pattern type="Registry">%HklmWowSoftware%\Adobe\Acrobat Reader\DC\Installer\* [*]</pattern>
            <pattern type="Registry">%HklmWowSoftware%\Adobe\Acrobat Reader\DC\InstallPath\* [*]</pattern>
          </objectSet>
        </exclude>
        <merge script="MigXmlHelper.SourcePriority()">
          <objectSet>
            <pattern type="File">%CSIDL_APPDATA%\Adobe\Acrobat\DC\* [*]</pattern>
          </objectSet>
        </merge>
      </rules>
    </role>
  </component>

  <!-- Adobe Acrobat DC -->
  <component context="UserAndSystem" type="Application">
    <displayName _locID="migapp.adobereader7">Adobe Acrobat DC</displayName>
    <environment name="GlobalEnv"/>
    <environment name="GlobalEnvX64"/>

    <environment>
      <variable name="ArobatProInstPath">
        <script>MigXmlHelper.GetStringContent("Registry","HKLM\Software\Adobe\Adobe Acrobat\DC\Installer [Path]","0","","\")</script>
      </variable>
    </environment>

    <role role="Settings">
      <detects>
        <detect>
          <condition>MigXmlHelper.DoesObjectExist("Registry","HKCU\Software\Adobe\Adobe Acrobat\DC")</condition>
        </detect>
        <detect>
          <condition>MigXmlHelper.DoesFileVersionMatch("%AcrobatProInstPath%\Acrobat\Acrobat.exe","ProductVersion","15.*")</condition>
          <condition>MigXmlHelper.DoesFileVersionMatch("%AcrobatProInstPath%\Acrobat\Acrobat.exe","ProductVersion","17.*")</condition>
        </detect>
      </detects>
      <rules context="User">
        <destinationCleanup>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bCacheFormData]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bFullScreenClick]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bOpenInPlace]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bAllowOpenFile]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bSaveAsLinearized]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bAllowByteRangeRequests]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bBrowserIntegration]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bDownloadEntireFile]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bAntialiasGraphics]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bAntialiasImages]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bAntialiasText]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bShowLargeDIBS]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bUseLogicalPageNumbers]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bDisplayAboutDialog]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bDisplayedSplash]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bEmitPostScriptXObjects]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [benableDDR]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bFullScreenIgnoreTrans]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bGreekText]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bIgnorePageClip]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bOverPrintPreview]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bUsePageCache]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bUseSlideTimer]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bUseSysSetting]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [bWrapSlideShowPages]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [iTrustedMode]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [iDefaultZoomType]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [iDefaultZoomScale]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [iPixelsPerInch]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [iAccessColorPolicy]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [iAntialiasThreshold]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [iPixelsPerInch]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [iDefaultMaxThreadZoom]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Originals [iNoteOpacity]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\DocumentStatus [bDocAttachmentStatus]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\DocumentStatus [bDocCertifiedStatus]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\DocumentStatus [bDocOCGStatus]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\DocumentStatus [bDocSecurityStatus]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\DocumentStatus [bDocSignatureStatus]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\DocumentStatus [bDocUserPropertiesStatus]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\DocumentStatus [bSuppressStatusDialog]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [AccessBackgroundColorBlue]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [AccessBackgroundColorGreen]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [AccessBackgroundColorRed]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [AccessColorPolicy]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [AccessMaxDocModePages]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [AccessOverrideDocColors]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [AccessPageMode]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [AccessTextColorBlue]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [AccessTextColorGreen]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [AccessTextColorRed]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [AllowByteRangeRequests]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [AllowOpenFile]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [AntialiasGraphics]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [AntialiasImages]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [AntialiasThreshold]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [AntialiasText]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [BrowserCheck]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [DisplayAboutDialog]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [DefaultMaxThreadZoom]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [DefaultSlideTimer]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [DefaultZoomScale]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [DefaultZoomType]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [DownloadEntireFile]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [enableDDR]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [FullScreenClick]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [FullScreenColorBlue]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [FullScreenColorGreen]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [FullScreenColorRed]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [FullScreenCursor]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [FullScreenEscape]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [FullScreenTransitionType]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [Gamma]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [GreekText]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [GreekThreshold]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [IgnorePageClip]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [NoteFontName]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [NotePointSize]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [OpenInPlace]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [PageUnits]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [PageViewLayoutMode]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [TransparencyGrid]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [TrustedMode]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [UpdateFrequency]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [UseLogicalPageNumbers]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [UsePageCache]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [UseSlideTimer]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AdobeViewer [WrapSlideShowPages]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\AVGeneral\cToolbars\* [bHidden]</pattern>
          </objectSet>
        </destinationCleanup>
        <include>
          <objectSet>
            <pattern type="File">%CSIDL_APPDATA%\Adobe\Acrobat\DC\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\* [*]</pattern>
          </objectSet>
        </include>
        <exclude>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Adobe\Adobe Acrobat\DC\Installer\* [*]</pattern>
            <pattern type="Registry">HKLM\Software\Adobe\Adobe Acrobat\DC\Installer\* [*]</pattern>
            <pattern type="Registry">HKLM\Software\Adobe\Adobe Acrobat\DC\InstallPath\* [*]</pattern>
            <pattern type="Registry">%HklmWowSoftware%\Adobe\Adobe Acrobat\DC\Installer\* [*]</pattern>
            <pattern type="Registry">%HklmWowSoftware%\Adobe\Adobe Acrobat\DC\InstallPath\* [*]</pattern>
          </objectSet>
        </exclude>
        <merge script="MigXmlHelper.SourcePriority()">
          <objectSet>
            <pattern type="File">%CSIDL_APPDATA%\Adobe\Acrobat\DC\* [*]</pattern>
          </objectSet>
        </merge>
      </rules>
    </role>
  </component>

  <!-- Yahoo! Messenger -->
  <component context="UserAndSystem" type="Application">
    <displayName _locID="migapp.yahoomessenger">Yahoo! Messenger</displayName>
    <environment name="GlobalEnv" />
    <environment name="GlobalEnvX64"/>
    <environment context="User">
      <variable name="YahooSkinPath">
        <objectSet>
          <content filter='MigXmlHelper.ExtractDirectory (NULL, "1")'>
            <objectSet>
              <pattern type="Registry">HKCU\Software\Yahoo\Pager\skins [Default_SkinDir]</pattern>
            </objectSet>
          </content>
        </objectSet>
      </variable>
    </environment>
    <environment context="System">
      <variable name="YahooMainDir">
        <script>MigXmlHelper.GetStringContent("Registry","%HklmWowSoftware%\Yahoo\Essentials [MainDir]")</script>
      </variable>
    </environment>
    <environment>
      <variable name="YahooLocalServer">
        <script>MigXmlHelper.GetStringContent("Registry","%HklmWowSoftware%\Classes\CLSID\{E5D12C4E-7B4F-11D3-B5C9-0050045C3C96}\LocalServer32 []")</script>
      </variable>
    </environment>
    <role role="Settings">
      <detects>
        <detect>
          <condition>MigXmlHelper.DoesObjectExist("Registry","HKCU\Software\Yahoo\Pager")</condition>
        </detect>
        <detect>
          <condition>MigXmlHelper.DoesFileVersionMatch("%YahooLocalServer%","ProductVersion","3,*")</condition>
          <condition>MigXmlHelper.DoesFileVersionMatch("%YahooLocalServer%","ProductVersion","4,*")</condition>
          <condition>MigXmlHelper.DoesFileVersionMatch("%YahooLocalServer%","ProductVersion","5,*")</condition>
          <condition>MigXmlHelper.DoesFileVersionMatch("%YahooLocalServer%","ProductVersion","6,*")</condition>
          <condition>MigXmlHelper.DoesFileVersionMatch("%YahooLocalServer%","ProductVersion","7,*")</condition>
          <condition>MigXmlHelper.DoesFileVersionMatch("%YahooLocalServer%","ProductVersion","8,*")</condition>
          <condition>MigXmlHelper.DoesFileVersionMatch("%YahooLocalServer%","ProductVersion","9,*")</condition>
        </detect>
      </detects>
      <rules context="User">
        <include>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Yahoo\Pager\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Microsoft\Windows\CurrentVersion\Run [Yahoo! Pager]</pattern>
            <pattern type="Registry">HKCU\Software\Yahoo\Companion\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Yahoo\YFriendsBar\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Yahoo\YServer\* [*]</pattern>
            <pattern type="File">%YahooSkinPath%\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Yahoo\Pager\Alerts [*Sound Name]</pattern>
            <content filter="MigXmlHelper.ExtractSingleFile(NULL, NULL)">
              <objectSet>
                <pattern type="Registry">HKCU\Software\Yahoo\Pager\Alerts [*Sound Name]</pattern>
              </objectSet>
            </content>
          </objectSet>
        </include>
        <exclude>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Yahoo\Pager [EOptions string]</pattern>
            <pattern type="Registry">HKCU\Software\Yahoo\Pager [Http Server]</pattern>
            <pattern type="Registry">HKCU\Software\Yahoo\Pager [IPLookup]</pattern>
            <pattern type="Registry">HKCU\Software\Yahoo\Pager [PreLogin]</pattern>
            <pattern type="Registry">HKCU\Software\Yahoo\Pager [socket server]</pattern>
            <pattern type="Registry">HKCU\Software\Yahoo\Pager [LatestSocketServerUrl]</pattern>
            <pattern type="Registry">HKCU\Software\Yahoo\Pager [EOptions string]</pattern>
            <pattern type="Registry">HKCU\Software\Yahoo\Pager\* [Default_SkinDir]</pattern>
            <pattern type="Registry">HKCU\Software\Yahoo\Pager\File Transfer\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Yahoo\Pager\Old Entries\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Yahoo\Pager\list\Messenger\ [Click Count]</pattern>
            <pattern type="Registry">HKCU\Software\Yahoo\Pager\Update\ [LastUpdaterRunTime]</pattern>
          </objectSet>
        </exclude>
        <merge script="MigXmlHelper.SourcePriority()">
          <objectSet>
            <pattern type="File">%YahooSkinPath%\* [*]</pattern>
          </objectSet>
        </merge>
        <destinationCleanup>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Microsoft\Windows\CurrentVersion\Run [Yahoo! Pager]</pattern>
          </objectSet>
        </destinationCleanup>
        <merge script="MigXmlHelper.DestinationPriority()">
          <objectSet>
            <pattern type="Registry">HKCU\Software\Yahoo\Pager\View\* [*]</pattern>
          </objectSet>
        </merge>
        <locationModify script="MigXmlHelper.RelativeMove('%YahooSkinPath%','%YahooSkinPath%')">
          <objectSet>
            <pattern type="File">%YahooSkinPath%\* [*]</pattern>
          </objectSet>
        </locationModify>
      </rules>
      <rules context="System">
        <!-- Yahoo Messenger LocalFiles.CopyFiles Yahoo Messenger LocalFiles.CopyFiles -->
        <include>
          <objectSet>
            <pattern type="File">%YahooMainDir%\Messenger\local [*]</pattern>
          </objectSet>
        </include>
      </rules>
    </role>
  </component>

  <!-- Zune Software 3 -->
  <component context="UserAndSystem"  type="Application">
    <displayName _locID="migapp.zune3">Zune Software</displayName>
    <environment name="GlobalEnv"/>
    <environment name="GlobalEnvX64"/>
    <environment>
      <variable name="ZuneInstallDir">
        <script>MigXmlHelper.GetStringContent("Registry","HKLM\Software\Microsoft\Zune [Installation Directory]")</script>
      </variable>
    </environment>
    <role role="Settings">
      <detection>
        <conditions>
          <conditions>
            <condition>MigXmlHelper.DoesObjectExist("Registry","HKLM\Software\Microsoft\Zune [Installation Directory]")</condition>
          </conditions>
          <conditions operation="OR">
            <condition>MigXmlHelper.DoesFileVersionMatch("%ZuneInstallDir%\Zune.exe","ProductVersion","3.*")</condition>
            <condition>MigXmlHelper.DoesFileVersionMatch("%ZuneInstallDir%\Zune.exe","ProductVersion","4.*")</condition>
          </conditions>
        </conditions>
      </detection>
      <rules context="User">
        <destinationCleanup>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Microsoft\Zune\* [*]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Zune\Art Cache\* [*]</pattern>
          </objectSet>
        </destinationCleanup>
        <include>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Microsoft\Zune\* [*]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Zune\* [*]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Windows Phone Update\* [*]</pattern>
          </objectSet>
        </include>
        <exclude>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Microsoft\Zune\FUE\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Microsoft\Zune\MediaStore\CachedResults\* [*]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Zune\Art Cache\* [*]</pattern>
          </objectSet>
        </exclude>
        <merge script="MigXmlHelper.SourcePriority()">
          <objectSet>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Zune\* [*]</pattern>
          </objectSet>
        </merge>
      </rules>
    </role>
  </component>

  <!-- Quicken Deluxe 2009 -->
  <component context="UserAndSystem"  type="Application">
    <displayName _locID="migapp.quicken2009">Quicken 2009</displayName>
    <environment name="GlobalEnv"/>
    <environment name="GlobalEnvX64"/>
    <role role="Settings">
      <detection>
        <conditions>
          <condition>MigXmlHelper.DoesObjectExist("Registry","%HklmWowSoftware%\Intuit\Quicken\2009 [ExePath]")</condition>
        </conditions>
      </detection>
      <rules context="User">
        <include>
          <objectSet>
            <pattern type="Ini">%CSIDL_APPDATA%\Intuit\Quicken\Config\QUSER.ini|RecentFiles[*]</pattern>
            <pattern type="Ini">%CSIDL_APPDATA%\Intuit\Quicken\Config\QUSER.ini|Quicken[NewCatPrompt]</pattern>
            <pattern type="Ini">%CSIDL_COMMON_APPDATA%\Intuit\Quicken\Config\quicken.ini|Quicken[*]</pattern>
            <pattern type="Ini">%CSIDL_COMMON_APPDATA%\Intuit\Quicken\Config\quicken.ini|Reconcile[Instruct]</pattern>
            <pattern type="Ini">%CSIDL_COMMON_APPDATA%\Intuit\Quicken\Config\quicken.ini|Internet[*]</pattern>
            <pattern type="Ini">%CSIDL_COMMON_APPDATA%\Intuit\Quicken\Config\quicken.ini|QPS[*]</pattern>
            <pattern type="Ini">%CSIDL_COMMON_APPDATA%\Intuit\Quicken\Config\quicken.ini|MarketingMessages[*]</pattern>
            <pattern type="Ini">%CSIDL_COMMON_APPDATA%\Intuit\Quicken\Config\quicken.ini|Business[*]</pattern>
            <pattern type="Ini">%CSIDL_COMMON_APPDATA%\Intuit\Quicken\Config\quicken.ini|WebConnect[*]</pattern>
            <pattern type="Ini">%CSIDL_COMMON_APPDATA%\Intuit\Quicken\Config\quicken.ini|Registration[*]</pattern>
          </objectSet>
        </include>
        <exclude>
          <objectSet>
            <pattern type="Ini">%CSIDL_COMMON_APPDATA%\Intuit\Quicken\Config\quicken.ini|Quicken[ExePath]</pattern>
            <pattern type="Ini">%CSIDL_COMMON_APPDATA%\Intuit\Quicken\Config\quicken.ini|Quicken[Platform]</pattern>
            <pattern type="Ini">%CSIDL_COMMON_APPDATA%\Intuit\Quicken\Config\quicken.ini|Quicken[Version]</pattern>
            <pattern type="Ini">%CSIDL_COMMON_APPDATA%\Intuit\Quicken\Config\quicken.ini|Quicken[QuickPayrollPath]</pattern>
            <pattern type="File">%CSIDL_COMMON_APPDATA%\Intuit\Quicken\Config [quicken.ini]</pattern>
          </objectSet>
        </exclude>
        <merge script="MigXmlHelper.SourcePriority()">
          <objectSet>
            <pattern type="File">%CSIDL_APPDATA%\Intuit\Quicken\Config [QUSER.ini]</pattern>
            <pattern type="File">%CSIDL_COMMON_APPDATA%\Intuit\Quicken\Config [quicken.ini]</pattern>
          </objectSet>
        </merge>
      </rules>
    </role>
  </component>

  <!--AOL Instant messenger 5 and 6 -->
  <component type="Application" context="UserAndSystem">
    <displayName _locID="migapp.AOLInstantmessenger">AOL Instant Messenger</displayName>
    <environment name="GlobalEnv" />
    <environment name="GlobalEnvX64"/>
    <environment>
      <variable name="AOLInstallPath">
        <script>MigXmlHelper.GetStringContent("Registry","%HklmWowSoftware%\Microsoft\Windows\CurrentVersion\App Paths\aim.exe [Path]")</script>
      </variable>
      <variable name="AOLInstallPath">
        <script>MigXmlHelper.GetStringContent("Registry","%HklmWowSoftware%\AOL\AIM\6 [Island]")</script>
      </variable>
    </environment>
    <environment context="User">
      <conditions>
        <condition>MigXmlHelper.DoesFileVersionMatch("%AOLInstallPath%\aim.exe","ProductVersion","5.*")</condition>
      </conditions>
      <variable name="AOLRegPath">
        <text>HKCU\Software\America Online\AOL Instant Messenger (TM)\CurrentVersion</text>
      </variable>
    </environment>
    <environment context="User">
      <conditions>
        <condition>MigXmlHelper.DoesFileVersionMatch("%AOLInstallPath%\aim6.exe","ProductVersion","1.*")</condition>
      </conditions>
      <variable name="AOLRegPath">
        <text>HKCU\Software\America Online\AIM6</text>
      </variable>
    </environment>
    <role role="Settings">
      <detects>
        <detect>
          <condition>MigXmlHelper.DoesObjectExist("Registry","%AOLRegPath%")</condition>
        </detect>
        <detect>
          <condition>MigXmlHelper.DoesFileVersionMatch("%AOLInstallPath%\aim.exe","ProductVersion","5.*")</condition>
          <condition>MigXmlHelper.DoesFileVersionMatch("%AOLInstallPath%\aim6.exe","ProductVersion","1.*")</condition>
        </detect>
      </detects>
      <rules context="User">
        <include>
          <objectSet>
            <pattern type="Registry">%AOLRegPath%\* [*]</pattern>
          </objectSet>
        </include>
        <exclude>
          <objectSet>
            <pattern type="Registry">%AOLRegPath%\Misc\ [BaseDataPath]</pattern>
            <pattern type="Registry">%AOLRegPath%\Misc\ [DataPath]</pattern>
            <pattern type="Registry">%AOLRegPath%\Login\* [*]</pattern>
            <pattern type="Registry">%AOLRegPath%\AppPath\* [*]</pattern>
            <pattern type="Registry">%AOLRegPath%\Buddy\* [*]</pattern>
            <pattern type="Registry">%AOLRegPath%\AutoUpgrade\* [*]</pattern>
            <pattern type="Registry">%AOLRegPath%\WindowPos\* [*]</pattern>
            <pattern type="Registry">%AOLRegPath%\Location\* [*]</pattern>
          </objectSet>
        </exclude>
      </rules>
    </role>
  </component>

  <!-- Mozilla Firefox -->
  <component context="UserAndSystem" type="Application">
    <displayName _locID="migapp.firefox">Mozilla Firefox</displayName>
    <environment name="GlobalEnv"/>
    <environment name="GlobalEnvX64"/>
    <role role="Settings">
      <detection name="Firefox" />
      <detection name="Firefox_x64" />
      <rules context="User">
        <destinationCleanup>
          <objectSet>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Mozilla\Firefox\Profiles\*\Cache\* [*]</pattern>
          </objectSet>
        </destinationCleanup>
        <include>
          <objectSet>
            <pattern type="File">%CSIDL_APPDATA%\Mozilla\Firefox\* [*]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Mozilla\Firefox\Profiles\* [*]</pattern>
          </objectSet>
        </include>
        <exclude>
          <objectSet>
            <pattern type="File">%CSIDL_APPDATA%\Mozilla\Firefox\Crash Reports\* [*]</pattern>
            <pattern type="File">%CSIDL_APPDATA%\Mozilla\Firefox\Profiles\*\ [pluginreg.dat]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Mozilla\Firefox\Profiles\*\Cache\* [*]</pattern>
          </objectSet>
        </exclude>
        <merge script="MigXmlHelper.SourcePriority()">
          <objectSet>
            <pattern type="File">%CSIDL_APPDATA%\Mozilla\Firefox\* [*]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Mozilla\Firefox\Profiles\* [*]</pattern>
          </objectSet>
        </merge>
      </rules>
    </role>
  </component>

  <!-- Opera 9 -->
  <component context="UserAndSystem" type="Application">
    <displayName _locID="migapp.opera9">Opera</displayName>
    <environment name="GlobalEnv"/>
    <environment name="GlobalEnvX64"/>
    <environment>
      <variable name="OperaInstallDir">
        <script>MigXmlHelper.GetStringContent("Registry","%HklmWowSoftware%\Netscape\Netscape Navigator\Opera\main [Install Directory]")</script>
      </variable>
    </environment>
    <role role="Settings">
      <detection>
        <conditions>
          <condition>MigXmlHelper.DoesFileVersionMatch("%OperaInstallDir%\opera.exe","ProductVersion","9.*")</condition>
        </conditions>
      </detection>
      <rules context="User">
        <include>
          <objectSet>
            <pattern type="Ini">%CSIDL_APPDATA%\Opera\Opera\profile\opera6.ini|User Prefs[*]</pattern>
            <pattern type="Ini">%CSIDL_APPDATA%\Opera\Opera\profile\opera6.ini|HotListWindow[*]</pattern>
            <pattern type="Ini">%CSIDL_APPDATA%\Opera\Opera\profile\opera6.ini|Security Prefs[*]</pattern>
            <pattern type="Ini">%CSIDL_APPDATA%\Opera\Opera\profile\opera6.ini|Windows[*]</pattern>
            <pattern type="Ini">%CSIDL_APPDATA%\Opera\Opera\profile\opera6.ini|Colors[*]</pattern>
            <pattern type="Ini">%CSIDL_APPDATA%\Opera\Opera\profile\opera6.ini|Proxy[*]</pattern>
            <pattern type="Ini">%CSIDL_APPDATA%\Opera\Opera\profile\opera6.ini|Performance[*]</pattern>
            <pattern type="Ini">%CSIDL_APPDATA%\Opera\Opera\profile\opera6.ini|Saved Settings[*]</pattern>
            <pattern type="Ini">%CSIDL_APPDATA%\Opera\Opera\profile\opera6.ini|Network[*]</pattern>
            <pattern type="Ini">%CSIDL_APPDATA%\Opera\Opera\profile\opera6.ini|Sounds[*]</pattern>
            <pattern type="Ini">%CSIDL_APPDATA%\Opera\Opera\profile\opera6.ini|Multimedia[*]</pattern>
            <pattern type="File">%CSIDL_APPDATA%\Opera\Opera\profile\* [*]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Opera\Opera\* [*]</pattern>
          </objectSet>
        </include>
        <exclude>
          <objectSet>
            <pattern type="File">%CSIDL_APPDATA%\Opera\Opera\profile [opera6.ini]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Opera\Opera\profile\cache4\* [*]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Opera\Opera\profile\opcache\* [*]</pattern>
          </objectSet>
        </exclude>
        <merge script="MigXmlHelper.SourcePriority()">
          <objectSet>
            <pattern type="File">%CSIDL_APPDATA%\Opera\Opera\profile\* [*]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Opera\Opera\* [*]</pattern>
          </objectSet>
        </merge>
      </rules>
    </role>
  </component>

  <!-- Google Chrome -->
  <component context="UserAndSystem" type="Application">
    <displayName _locID="migapp.chrome1">Google Chrome</displayName>
    <environment name="GlobalEnv"/>
    <environment name="GlobalEnvX64"/>
    <role role="Settings">
      <destinationCleanup>
        <objectSet>
          <pattern type="File">%CSIDL_LOCAL_APPDATA%\Google\Chrome\User Data\*\Cache\* [*]</pattern>
        </objectSet>
      </destinationCleanup>
      <detection name="Chrome_User" />
      <detection name="Chrome_x64User" />
      <detection name="Chrome" />
      <detection name="Chrome_x64" />
      <rules context="User">
        <include>
          <objectSet>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Google\Chrome\User Data\* [*]</pattern>
          </objectSet>
        </include>
        <exclude>
          <objectSet>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Google\Chrome\User Data\*\Cache\* [*]</pattern>
          </objectSet>
        </exclude>
        <merge script="MigXmlHelper.SourcePriority()">
          <objectSet>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Google\Chrome\User Data\* [*]</pattern>
          </objectSet>
        </merge>
      </rules>
    </role>
  </component>

  <!-- Skype 3 -->
  <component type="Application" context="UserAndSystem">
    <displayName _locID="migapp.Skype">Skype</displayName>
    <environment name="GlobalEnv" />
    <environment name="GlobalEnvX64"/>
    <environment>
      <variable name="SkypeExe">
        <script>MigXmlHelper.GetStringContent("Registry","%HklmWowSoftware%\Skype\Phone [SkypePath]")</script>
      </variable>
    </environment>
    <role role="Settings">
      <detects>
        <detect>
          <condition>MigXmlHelper.DoesFileVersionMatch("%SkypeExe%","ProductVersion","3.*")</condition>
        </detect>
      </detects>
      <rules context="User">
        <include>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Skype\Installer\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Skype\Phone\UI\General\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Skype\PluginManager\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Skype\ProtectedStorage\* [*]</pattern>
            <pattern type="File">%CSIDL_APPDATA%\Skype\* [*]</pattern>
          </objectSet>
        </include>
        <exclude>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Skype\PluginManager [Plugins Root]</pattern>
          </objectSet>
        </exclude>
        <merge script="MigXmlHelper.SourcePriority()">
          <objectSet>
            <pattern type="File">%CSIDL_APPDATA%\Skype\* [*]</pattern>
          </objectSet>
        </merge>
      </rules>
    </role>
  </component>

  <!-- Google Talk 1 -->
  <component type="Application" context="UserAndSystem">
    <displayName _locID="migapp.GoogleTalk">Google Talk</displayName>
    <environment name="GlobalEnv" />
    <environment name="GlobalEnvX64"/>
    <role role="Settings">
      <detection>
        <conditions>
          <condition>MigXmlHelper.DoesObjectExist("Registry","HKCU\Software\Google\Google Talk")</condition>
          <conditions operation="OR">
            <!-- For XP, Vista and Win7 Compat Mode -->
            <condition>MigXmlHelper.DoesFileVersionMatch("%ProgramFiles32bit%\Google\Google Talk\googletalk.exe","ProductVersion","1,*")</condition>
            <!-- For Win7 -->
            <condition>MigXmlHelper.DoesFileVersionMatch("%CSIDL_APPDATA%\Google\Google Talk\googletalk.exe","ProductVersion","1,*")</condition>
          </conditions>
        </conditions>
      </detection>
      <rules context="User">
        <include>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Google\Google Talk\Accounts\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Google\Google Talk\Options\* [*]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Google\Google Talk\avatars\* [*]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Google\Google Talk\chatlogs\* [*]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Google\Google Talk\themes\user\* [*]</pattern>
          </objectSet>
        </include>
        <merge script="MigXmlHelper.SourcePriority()">
          <objectSet>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Google\Google Talk\avatars\* [*]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Google\Google Talk\chatlogs\* [*]</pattern>
            <pattern type="File">%CSIDL_LOCAL_APPDATA%\Google\Google Talk\themes\user\* [*]</pattern>
          </objectSet>
        </merge>
      </rules>
    </role>
  </component>

  <!-- Google Picasa 3 -->
  <component type="Application" context="UserAndSystem">
    <displayName _locID="migapp.GooglePicasa">Google Picasa</displayName>
    <environment name="GlobalEnv" />
    <environment name="GlobalEnvX64"/>
    <environment>
      <variable name="GooglePicasaInstallPath" remap="Yes">
        <script>MigXmlHelper.GetStringContent("Registry","%HklmWowSoftware%\Google\Picasa\Picasa2 []","0",'"','"\')</script>
      </variable>
    </environment>
    <role role="Settings">
      <detects>
        <detect>
          <condition>MigXmlHelper.DoesFileVersionMatch("%GooglePicasaInstallPath%\Picasa3.exe","ProductVersion","3.*")</condition>
        </detect>
      </detects>
      <rules context="User">
        <destinationCleanup>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Google\Picasa\Picasa2\Preferences [*]</pattern>
            <pattern type="Registry">HKCU\Software\Google\Picasa\Picasa2\Preferences\Buttons\* [*]</pattern>
          </objectSet>
        </destinationCleanup>
        <include>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Google\Picasa\* [*]</pattern>
          </objectSet>
        </include>
        <exclude>
          <objectSet>
            <pattern type="Registry">HKCU\Software\Google\Picasa\* [cacheroot]</pattern>
            <pattern type="Registry">HKCU\Software\Google\Picasa\Picasa2\resvars\* [*]</pattern>
            <pattern type="Registry">HKCU\Software\Google\Picasa\Picasa2\Runtime\* [*]</pattern>
          </objectSet>
        </exclude>
      </rules>
    </role>
  </component>

  <!-- Microsoft Office 15 -->
  <component context="UserAndSystem"  type="Application">
    <displayName _locID="migapp.office15">Microsoft Office 15</displayName>
    <environment name="GlobalEnv"/>
    <environment name="GlobalEnvX64"/>
    <environment>
      <variable name="OFFICEVERSION">
        <text>15.0</text>
      </variable>
    </environment>
    <role role="Container">
      <detection name="Access" />
      <detection name="Access_x64" />
      <detection name="Excel" />
      <detection name="Excel_x64" />
      <detection name="OneNote" />
      <detection name="OneNote_x64" />
      <detection name="Outlook" />
      <detection name="Outlook_x64" />
      <detection name="PowerPoint" />
      <detection name="PowerPoint_x64" />
      <detection name="Project15" />
      <detection name="Project15_x64" />
      <detection name="Publisher" />
      <detection name="Publisher_x64" />
      <detection name="Visio15" />
      <detection name="Visio15_x64" />
      <detection name="Word" />
      <detection name="Word_x64" />
      <detection name="InfoPath" />
      <detection name="InfoPath_x64" />
      <detection name="SharePointDesigner" />
      <detection name="SharePointDesigner_x64" />
      <detection name="Lync15" />
      <detection name="Lync15_x64" />

      <!-- Office 15 Common Settings -->
      <component context="UserAndSystem" type="Application" hidden="TRUE">
        <displayName _locID="migapp.office15common">Office 15 Common Settings</displayName>
        <role role="Settings">
          <!-- For Office 15 -->
          <rules>
            <destinationCleanup>
              <objectSet>
                <!--<pattern type="Registry">HKCU\software\Microsoft\Office\15.0\Common [Theme]</pattern>-->
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Common\Internet\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Common\Toolbars\* [*]</pattern>
              </objectSet>
            </destinationCleanup>
            <include filter='MigXmlHelper.IgnoreIrrelevantLinks()'>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Common\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\User Settings\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Shared Tools\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Templates\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office\15.0\* [*]</pattern>
                <!-- Quick access toolbars -->
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office [*.qat]</pattern>
                <!-- Extract custom dictionaries and related files -->
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Proof\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\UProof\* [*]</pattern>
                <content filter="MigXmlHelper.ExtractSingleFile(NULL, NULL)">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Shared Tools\Proofing Tools\*\Custom Dictionaries [*]</pattern>
                  </objectSet>
                </content>
                <!-- Web Extensibility Framework (WEF) -->
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\WEF\* [*]</pattern>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Common\Internet\NetworkStatusCache\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Common\Open Find\* [*]</pattern>
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office\15.0\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office [*.qat]</pattern>
                <!-- Custom dictionaries -->
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Proof\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\UProof\* [*]</pattern>
                <content filter="MigXmlHelper.ExtractSingleFile(NULL, NULL)">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Shared Tools\Proofing Tools\*\Custom Dictionaries [*]</pattern>
                  </objectSet>
                </content>
              </objectSet>
            </merge>
          </rules>
        </role>
      </component>
      <!-- Microsoft Office Access 15 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office15access">Microsoft Office Access 15</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Access</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Access" />
          <detection name="Access_x64" />
          <rules>
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings\* [*] </pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Access\* [*]</pattern>
              </objectSet>
            </include>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Access\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules>
            <include>
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [Access15.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\* [*.mdw]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Access\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\CMA\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Common\Toolbars\Settings\ [Microsoft Access]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\File MRU\* [*]</pattern>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRU1]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRU2]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRU3]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRU4]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRU5]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRU6]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRU7]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRU8]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRU9]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRUFlags1]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRUFlags2]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRUFlags3]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRUFlags4]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRUFlags5]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRUFlags6]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRUFlags7]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRUFlags8]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Settings [MRUFlags9]</pattern>
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.DestinationPriority()">
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Access\Options [Default Database Directory]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office15to16SettingsUpgrade" />
          <rules name="Office15to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office Excel 15 -->
      <component  context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office15excel">Microsoft Office Excel 15</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Excel</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Excel" />
          <detection name="Excel_x64" />
          <rules>
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Excel\Error Checking\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Excel\Internet\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Excel\Options\* [*]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Excel\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Excel\* [*]</pattern>
              </objectSet>
            </include>
          </rules>
          <rules name="Office15to16SettingsUpgrade" />
          <rules name="Office15to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office OneNote 15 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office15onenote">Microsoft Office OneNote 15</displayName>
        <environment>
          <variable name="OneNoteCachePath">
            <script>MigXmlHelper.GetStringContent("Registry","HKCU\Software\Microsoft\Office\15.0\OneNote\General [CachePath]")</script>
          </variable>
          <variable name="OFFICEPROGRAM">
            <text>OneNote</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="OneNote" />
          <detection name="OneNote_x64" />
          <rules>
            <destinationCleanup>
              <objectSet>
                <pattern type="File">%OneNoteCachePath%\OneNoteOfflineCache_Files\* [*]</pattern>
                <pattern type="File">%OneNoteCachePath% [OneNoteOfflineCache.onecache]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\OneNote\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\OneNote\15.0\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office [OneNote.officeUI]</pattern>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\OneNote\Options\Other [EnableAudioSearch]</pattern>
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\OneNote\15.0\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office [OneNote.officeUI]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office15to16SettingsUpgrade" />
          <rules name="Office15to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office InfoPath 15 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office15infopath">Microsoft Office InfoPath 15</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>OneNote</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="InfoPath" />
          <detection name="InfoPath_x64" />
          <rules>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\InfoPath\* [*]</pattern>
              </objectSet>
            </include>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\InfoPath\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office15to16SettingsUpgrade" />
          <rules name="Office15to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office SharePoint Designer 15 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office15sharepointdesigner">Microsoft SharePoint Designer 15</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>SharePointDesigner</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="SharePointDesigner" />
          <detection name="SharePointDesigner_x64" />
          <rules>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\SharePoint Designer\* [*]</pattern>
              </objectSet>
            </include>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\SharePoint Designer\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office15to16SettingsUpgrade" />
          <rules name="Office15to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office Outlook 2013 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office15outlook">Microsoft Office Outlook 2013</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Outlook</text>
          </variable>
          <variable name="OUTLOOKPROFILESPATH">
            <text>HKCU\Software\Microsoft\Office\15.0\Outlook\Profiles\</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Outlook" />
          <detection name="Outlook_x64" />
          <rules name="OutlookPstPab" />
          <rules context="User">
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Outlook\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Outlook\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Exchange\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Outlook\Profiles\* [*]</pattern>

                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [*.officeUI]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office [*.officeUI]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Templates\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Stationery\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Signatures\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\FORMS [frmcache.dat]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Outlook\* [*]</pattern>
                <!-- Move .pst files -->
                <content filter="MigXmlHelper.ExtractSingleFile(NULL,'NULL')">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Outlook\Search\* [*]</pattern>
                  </objectSet>
                </content>
                <!-- Move journals -->
                <content filter="MigXmlHelper.ExtractSingleFile(NULL,'%CSIDL_LOCAL_APPDATA%\Microsoft\Outlook')">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Outlook\Journal\* [*]</pattern>
                  </objectSet>
                </content>
                <!-- Move .FAV files -->
                <content filter="MigXmlHelper.ExtractSingleFile(NULL, NULL)">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Outlook\Profiles\* [001e023d]</pattern>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Outlook\Profiles\* [001f023d]</pattern>
                  </objectSet>
                </content>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <!-- We don't migrate .ost files, as recommended by the Outlook team -->
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Outlook\* [*.ost]</pattern>
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook\* [*.srs]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook\* [*.xml]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook\* [*.dat]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\FORMS [frmcache.dat]</pattern>
              </objectSet>
            </merge>
            <merge script="MigXmlHelper.DestinationPriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook [*.rwz]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office15to16SettingsUpgrade" />
          <rules name="Office15to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office PowerPoint 15 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office15powerpoint">Microsoft Office PowerPoint 15</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>PowerPoint</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="PowerPoint" />
          <detection name="PowerPoint_x64" />
          <rules>
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\PowerPoint\Options\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\PowerPoint\Internet\* [*]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\PowerPoint\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\PowerPoint\* [*]</pattern>
              </objectSet>
            </include>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\PowerPoint\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office15to16SettingsUpgrade" />
          <rules name="Office15to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Project 15 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office15project">Microsoft Project 15</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Project</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Project15" />
          <detection name="Project15_x64" />
          <rules>
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\MS Project\Options\* [*]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\MS Project\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\MS Project\15\* [*]</pattern>
              </objectSet>
            </include>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\MS Project\15\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office15to16SettingsUpgrade" />
          <rules name="Office15to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office Publisher 15 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office15publisher">Microsoft Office Publisher 2013</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Publisher</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Publisher" />
          <detection name="Publisher_x64" />
          <rules>
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Publisher\Preferences\* [*]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Publisher\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Publisher\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Publisher Building Blocks\* [*]</pattern>
              </objectSet>
            </include>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Publisher\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Publisher Building Blocks\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office15to16SettingsUpgrade" />
          <rules name="Office15to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office SmartTags -->
      <component context="User" type="Application">
        <displayName _locID="migapp.office15smarttag">Microsoft Office SmartTags</displayName>
        <role role="Container">
          <detection name="MicrosoftOutlookEmailRecipientsSmartTags" />
          <detection name="MicrosoftListsSmartTags15" />
          <detection name="MicrosoftPlaceSmartTags" />

          <!-- Microsoft Outlook Email Recipients SmartTags -->
          <component context="User" type="Application">
            <displayName _locID="migapp.office15emailsmarttag">Microsoft Outlook Email Recipients SmartTags</displayName>
            <role role="Settings">
              <detection name="MicrosoftOutlookEmailRecipientsSmartTags" />
              <rules>
                <destinationCleanup>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{4FFB3E8B-AE75-48F2-BF13-D0D7E93FA8F9} [*]</pattern>
                  </objectSet>
                </destinationCleanup>
                <include>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{4FFB3E8B-AE75-48F2-BF13-D0D7E93FA8F9}\* [*]</pattern>
                  </objectSet>
                </include>
              </rules>
            </role>
          </component>

          <!-- Microsoft Lists SmartTags -->
          <component context="User" type="Application">
            <displayName _locID="migapp.office15listsmarttag">Microsoft Lists SmartTags</displayName>
            <role role="Settings">
              <detection name="MicrosoftListsSmartTags15" />
              <rules>
                <destinationCleanup>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{64AB6C69-B40E-40AF-9B7F-F5687B48E2B6}\* [*]</pattern>
                  </objectSet>
                </destinationCleanup>
                <include>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{64AB6C69-B40E-40AF-9B7F-F5687B48E2B6}\* [*]</pattern>
                  </objectSet>
                </include>
              </rules>
            </role>
          </component>

          <!-- Microsoft Place SmartTags -->
          <component context="User" type="Application">
            <displayName _locID="migapp.office15placesmarttag">Microsoft Place SmartTags</displayName>
            <role role="Settings">
              <detection name="MicrosoftPlaceSmartTags" />
              <rules>
                <destinationCleanup>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{87EF1CFE-51CA-4E6B-8C76-E576AA926888} [*]</pattern>
                  </objectSet>
                </destinationCleanup>
                <include>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{87EF1CFE-51CA-4E6B-8C76-E576AA926888}\* [*]</pattern>
                  </objectSet>
                </include>
              </rules>
            </role>
          </component>
        </role>
      </component>

      <!-- Microsoft Office Visio 15 -->
      <component type="Application" context="UserAndSystem">
        <displayName _locID="migapp.visio15">Microsoft Office Visio 15</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Visio</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Visio15" />
          <detection name="Visio15_x64" />
          <rules context="User">
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\software\Microsoft\Office\15.0\Visio\Application\* [*]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\software\Microsoft\Office\15.0\Visio\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Visio\* [*]</pattern>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Visio\Application [LicenseCache]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Visio\Application [ConfigChangeID]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Visio\Application [MyShapesPath]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Visio\Application [DrawingsPath]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Visio\Application [StartUpPath]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Visio\Application [StencilPath]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Visio\Application [TemplatePath]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Visio\Quick Shapes\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Visio\Security\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Visio\Recent Templates\* [*]</pattern>
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Visio\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office15to16SettingsUpgrade" />
          <rules name="Office15to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office Lync 15 -->
      <component type="Application" context="UserAndSystem">
        <displayName _locID="migapp.lync15">Microsoft Office Lync 15</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Lync</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Lync15" />
          <detection name="Lync15_x64" />
          <rules context="User">
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\software\Microsoft\Office\15.0\Lync\Application\* [*]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\software\Microsoft\Office\15.0\Lync\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Lync\* [*]</pattern>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <!--
                <enter information here>
                -->
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Lync\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office15to16SettingsUpgrade" />
          <rules name="Office15to16SettingsUpgrade_x64" />
        </role>
      </component>

      <!-- Microsoft Office Word 15 (32-bit) -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office15word32bit">Microsoft Office Word 2013 (32-bit)</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Word</text>
          </variable>
          <variable name="OFFICEVERSION">
            <text>15.0</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Word" />
          <detection name="Word_x64"/>
          <rules>
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\software\Microsoft\Office\15.0\Word\Data\* [*]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Word\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Common\Toolbars\Word\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Common\Research\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Common\General\[SharedDocumentParts]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Common\General\[SharedTemplates]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Common\General\[Templates]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Common\General\[Themes]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Blog \* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Common\Spotlight\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Templates\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Proof\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\UProof\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\QuickStyles\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Document Building Blocks\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Bibliography\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office\ [Word.qat]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office\ [Word15.customUI]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [Word15.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [WordMa15.pip]</pattern>
              </objectSet>
            </include>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Templates\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Proof\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\UProof\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\QuickStyles\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office\ [Word.qat]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office\ [Word15.customUI]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [Word15.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [WordMa15.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [WordMa15.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Document Building Blocks\* [*]</pattern>
              </objectSet>
            </merge>
            <unconditionalExclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Word\Options\[PROGRAMDIR]</pattern>
                <!-- A user would only set these two setting to mitigate performance issues on an older machine. It's likely that users are upgrading to a more powerful machine, so let the defaults kick back in for these settings -->
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Word\Options\[LiveDrag]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\15.0\Word\Options\[LivePreview]</pattern>
                <!-- We can't know if the source \Word\Data\ blobs will be valid on the destination system, so exclude them-->
                <pattern type="Registry">HKCU\software\Microsoft\Office\15.0\Word\Data\* [*]</pattern>
              </objectSet>
            </unconditionalExclude>
          </rules>
          <rules name="Office15to16SettingsUpgrade" />
          <rules name="Office15to16SettingsUpgrade_x64"/>
        </role>
      </component>

    </role>
  </component>

  <!-- Microsoft Office 16 -->
  <component context="UserAndSystem"  type="Application">
    <displayName _locID="migapp.office16">Microsoft Office 16</displayName>
    <environment name="GlobalEnv"/>
    <environment name="GlobalEnvX64"/>
    <environment>
      <variable name="OFFICEVERSION">
        <text>16.0</text>
      </variable>
    </environment>
    <role role="Container">
      <detection name="Access" />
      <detection name="Access_x64" />
      <detection name="Excel" />
      <detection name="Excel_x64" />
      <detection name="OneNote" />
      <detection name="OneNote_x64" />
      <detection name="Outlook" />
      <detection name="Outlook_x64" />
      <detection name="PowerPoint" />
      <detection name="PowerPoint_x64" />
      <detection name="Project16" />
      <detection name="Project16_x64" />
      <detection name="Publisher" />
      <detection name="Publisher_x64" />
      <detection name="Visio16" />
      <detection name="Visio16_x64" />
      <detection name="Word" />
      <detection name="Word_x64" />
      <detection name="InfoPath" />
      <detection name="InfoPath_x64" />
      <detection name="SharePointDesigner" />
      <detection name="SharePointDesigner_x64" />
      <detection name="Lync16" />
      <detection name="Lync16_x64" />

      <!-- Office 16 Common Settings -->
      <component context="UserAndSystem" type="Application" hidden="TRUE">
        <displayName _locID="migapp.office16common">Office 16 Common Settings</displayName>
        <role role="Settings">
          <!-- For Office 16 -->
          <rules>
            <destinationCleanup>
              <objectSet>
                <!--<pattern type="Registry">HKCU\software\Microsoft\Office\16.0\Common [Theme]</pattern>-->
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Common\Internet\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Common\Toolbars\* [*]</pattern>
              </objectSet>
            </destinationCleanup>
            <include filter='MigXmlHelper.IgnoreIrrelevantLinks()'>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Common\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\User Settings\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Shared Tools\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Templates\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office\16.0\* [*]</pattern>
                <!-- Quick access toolbars -->
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office [*.qat]</pattern>
                <!-- Extract custom dictionaries and related files -->
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Proof\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\UProof\* [*]</pattern>
                <content filter="MigXmlHelper.ExtractSingleFile(NULL, NULL)">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Shared Tools\Proofing Tools\*\Custom Dictionaries [*]</pattern>
                  </objectSet>
                </content>
                <!-- Web Extensibility Framework (WEF) -->
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\WEF\* [*]</pattern>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Common\Internet\NetworkStatusCache\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Common\Open Find\* [*]</pattern>
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office\16.0\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office [*.qat]</pattern>
                <!-- Custom dictionaries -->
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Proof\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\UProof\* [*]</pattern>
                <content filter="MigXmlHelper.ExtractSingleFile(NULL, NULL)">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Shared Tools\Proofing Tools\*\Custom Dictionaries [*]</pattern>
                  </objectSet>
                </content>
              </objectSet>
            </merge>
          </rules>
        </role>
      </component>
      <!-- Microsoft Office Access 16 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office16access">Microsoft Office Access 16</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Access</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Access" />
          <detection name="Access_x64" />
          <rules>
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings\* [*] </pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Access\* [*]</pattern>
              </objectSet>
            </include>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Access\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules>
            <include>
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [Access16.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\* [*.mdw]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Access\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\CMA\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Common\Toolbars\Settings\ [Microsoft Access]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\File MRU\* [*]</pattern>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRU1]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRU2]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRU3]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRU4]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRU5]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRU6]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRU7]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRU8]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRU9]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRUFlags1]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRUFlags2]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRUFlags3]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRUFlags4]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRUFlags5]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRUFlags6]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRUFlags7]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRUFlags8]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Settings [MRUFlags9]</pattern>
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.DestinationPriority()">
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Access\Options [Default Database Directory]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office16to16SettingsMigrate" />
          <rules name="Office16to16SettingsMigrate_x64" />
        </role>
      </component>

      <!-- Microsoft Office Excel 16 -->
      <component  context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office16excel">Microsoft Office Excel 16</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Excel</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Excel" />
          <detection name="Excel_x64" />
          <rules>
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Excel\Error Checking\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Excel\Internet\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Excel\Options\* [*]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Excel\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Excel\* [*]</pattern>
              </objectSet>
            </include>
          </rules>
          <rules name="Office16to16SettingsMigrate" />
          <rules name="Office16to16SettingsMigrate_x64" />
        </role>
      </component>

      <!-- Microsoft Office OneNote 16 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office16onenote">Microsoft Office OneNote 16</displayName>
        <environment>
          <variable name="OneNoteCachePath">
            <script>MigXmlHelper.GetStringContent("Registry","HKCU\Software\Microsoft\Office\16.0\OneNote\General [CachePath]")</script>
          </variable>
          <variable name="OFFICEPROGRAM">
            <text>OneNote</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="OneNote" />
          <detection name="OneNote_x64" />
          <rules>
            <destinationCleanup>
              <objectSet>
                <pattern type="File">%OneNoteCachePath%\OneNoteOfflineCache_Files\* [*]</pattern>
                <pattern type="File">%OneNoteCachePath% [OneNoteOfflineCache.onecache]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\OneNote\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\OneNote\16.0\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office [OneNote.officeUI]</pattern>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\OneNote\Options\Other [EnableAudioSearch]</pattern>
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\OneNote\16.0\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office [OneNote.officeUI]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office16to16SettingsMigrate" />
          <rules name="Office16to16SettingsMigrate_x64" />
        </role>
      </component>

      <!-- Microsoft Office InfoPath 16 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office16infopath">Microsoft Office InfoPath 16</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>OneNote</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="InfoPath" />
          <detection name="InfoPath_x64" />
          <rules>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\InfoPath\* [*]</pattern>
              </objectSet>
            </include>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\InfoPath\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office16to16SettingsMigrate" />
          <rules name="Office16to16SettingsMigrate_x64" />
        </role>
      </component>

      <!-- Microsoft Office SharePoint Designer 16 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office16sharepointdesigner">Microsoft SharePoint Designer 16</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>SharePointDesigner</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="SharePointDesigner" />
          <detection name="SharePointDesigner_x64" />
          <rules>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\SharePoint Designer\* [*]</pattern>
              </objectSet>
            </include>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\SharePoint Designer\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office16to16SettingsMigrate" />
          <rules name="Office16to16SettingsMigrate_x64" />
        </role>
      </component>

      <!-- Microsoft Office Outlook 2016 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office16outlook">Microsoft Office Outlook 2016</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Outlook</text>
          </variable>
          <variable name="OUTLOOKPROFILESPATH">
            <text>HKCU\Software\Microsoft\Office\16.0\Outlook\Profiles\</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Outlook" />
          <detection name="Outlook_x64" />
          <rules name="OutlookPstPab" />
          <rules context="User">
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Outlook\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Outlook\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Exchange\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Outlook\Profiles\* [*]</pattern>

                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office [*.officeUI]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office [*.officeUI]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Templates\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Stationery\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Signatures\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\FORMS [frmcache.dat]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Outlook\* [*]</pattern>
                <!-- Move .pst files -->
                <content filter="MigXmlHelper.ExtractSingleFile(NULL,'NULL')">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Outlook\Search\* [*]</pattern>
                  </objectSet>
                </content>
                <!-- Move journals -->
                <content filter="MigXmlHelper.ExtractSingleFile(NULL,'%CSIDL_LOCAL_APPDATA%\Microsoft\Outlook')">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Outlook\Journal\* [*]</pattern>
                  </objectSet>
                </content>
                <!-- Move .FAV files -->
                <content filter="MigXmlHelper.ExtractSingleFile(NULL, NULL)">
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Outlook\Profiles\* [001e023d]</pattern>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Outlook\Profiles\* [001f023d]</pattern>
                  </objectSet>
                </content>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <!-- We don't migrate .ost files, as recommended by the Outlook team -->
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Outlook\* [*.ost]</pattern>
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook\* [*.srs]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook\* [*.xml]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook\* [*.dat]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\FORMS [frmcache.dat]</pattern>
              </objectSet>
            </merge>
            <merge script="MigXmlHelper.DestinationPriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Outlook [*.rwz]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office16to16SettingsMigrate" />
          <rules name="Office16to16SettingsMigrate_x64" />
        </role>
      </component>

      <!-- Microsoft Office PowerPoint 16 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office16powerpoint">Microsoft Office PowerPoint 16</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>PowerPoint</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="PowerPoint" />
          <detection name="PowerPoint_x64" />
          <rules>
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\PowerPoint\Options\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\PowerPoint\Internet\* [*]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\PowerPoint\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\PowerPoint\* [*]</pattern>
              </objectSet>
            </include>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\PowerPoint\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office16to16SettingsMigrate" />
          <rules name="Office16to16SettingsMigrate_x64" />
        </role>
      </component>

      <!-- Microsoft Project 16 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office16project">Microsoft Project 16</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Project</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Project16" />
          <detection name="Project16_x64" />
          <rules>
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\MS Project\Options\* [*]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\MS Project\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\MS Project\16\* [*]</pattern>
              </objectSet>
            </include>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\MS Project\16\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office16to16SettingsMigrate" />
          <rules name="Office16to16SettingsMigrate_x64" />
        </role>
      </component>

      <!-- Microsoft Office Publisher 16 -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office16publisher">Microsoft Office Publisher 2016</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Publisher</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Publisher" />
          <detection name="Publisher_x64" />
          <rules>
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Publisher\Preferences\* [*]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Publisher\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Publisher\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Publisher Building Blocks\* [*]</pattern>
              </objectSet>
            </include>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Publisher\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Publisher Building Blocks\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office16to16SettingsMigrate" />
          <rules name="Office16to16SettingsMigrate_x64" />
        </role>
      </component>

      <!-- Microsoft Office SmartTags -->
      <component context="User" type="Application">
        <displayName _locID="migapp.office16smarttag">Microsoft Office SmartTags</displayName>
        <role role="Container">
          <detection name="MicrosoftOutlookEmailRecipientsSmartTags" />
          <detection name="MicrosoftListsSmartTags16" />
          <detection name="MicrosoftPlaceSmartTags" />

          <!-- Microsoft Outlook Email Recipients SmartTags -->
          <component context="User" type="Application">
            <displayName _locID="migapp.office16emailsmarttag">Microsoft Outlook Email Recipients SmartTags</displayName>
            <role role="Settings">
              <detection name="MicrosoftOutlookEmailRecipientsSmartTags" />
              <rules>
                <destinationCleanup>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{4FFB3E8B-AE75-48F2-BF13-D0D7E93FA8F9} [*]</pattern>
                  </objectSet>
                </destinationCleanup>
                <include>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{4FFB3E8B-AE75-48F2-BF13-D0D7E93FA8F9}\* [*]</pattern>
                  </objectSet>
                </include>
              </rules>
            </role>
          </component>

          <!-- Microsoft Lists SmartTags -->
          <component context="User" type="Application">
            <displayName _locID="migapp.office16listsmarttag">Microsoft Lists SmartTags</displayName>
            <role role="Settings">
              <detection name="MicrosoftListsSmartTags16" />
              <rules>
                <destinationCleanup>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{64AB6C69-B40E-40AF-9B7F-F5687B48E2B6}\* [*]</pattern>
                  </objectSet>
                </destinationCleanup>
                <include>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{64AB6C69-B40E-40AF-9B7F-F5687B48E2B6}\* [*]</pattern>
                  </objectSet>
                </include>
              </rules>
            </role>
          </component>

          <!-- Microsoft Place SmartTags -->
          <component context="User" type="Application">
            <displayName _locID="migapp.office16placesmarttag">Microsoft Place SmartTags</displayName>
            <role role="Settings">
              <detection name="MicrosoftPlaceSmartTags" />
              <rules>
                <destinationCleanup>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{87EF1CFE-51CA-4E6B-8C76-E576AA926888} [*]</pattern>
                  </objectSet>
                </destinationCleanup>
                <include>
                  <objectSet>
                    <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Smart Tag\Recognizers\{87EF1CFE-51CA-4E6B-8C76-E576AA926888}\* [*]</pattern>
                  </objectSet>
                </include>
              </rules>
            </role>
          </component>
        </role>
      </component>

      <!-- Microsoft Office Visio 16 -->
      <component type="Application" context="UserAndSystem">
        <displayName _locID="migapp.visio16">Microsoft Office Visio 16</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Visio</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Visio16" />
          <detection name="Visio16_x64" />
          <rules context="User">
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\software\Microsoft\Office\16.0\Visio\Application\* [*]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\software\Microsoft\Office\16.0\Visio\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Visio\* [*]</pattern>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Visio\Application [LicenseCache]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Visio\Application [ConfigChangeID]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Visio\Application [MyShapesPath]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Visio\Application [DrawingsPath]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Visio\Application [StartUpPath]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Visio\Application [StencilPath]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Visio\Application [TemplatePath]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Visio\Quick Shapes\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Visio\Security\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Visio\Recent Templates\* [*]</pattern>
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Visio\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office16to16SettingsMigrate" />
          <rules name="Office16to16SettingsMigrate_x64" />
        </role>
      </component>

      <!-- Microsoft Office Lync 16 -->
      <component type="Application" context="UserAndSystem">
        <displayName _locID="migapp.lync16">Microsoft Office Lync 16</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Lync</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Lync16" />
          <detection name="Lync16_x64" />
          <rules context="User">
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\software\Microsoft\Office\16.0\Lync\Application\* [*]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\software\Microsoft\Office\16.0\Lync\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Lync\* [*]</pattern>
              </objectSet>
            </include>
            <exclude>
              <objectSet>
                <!--
                <enter information here>
                -->
              </objectSet>
            </exclude>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Lync\* [*]</pattern>
              </objectSet>
            </merge>
          </rules>
          <rules name="Office16to16SettingsMigrate" />
          <rules name="Office16to16SettingsMigrate_x64" />
        </role>
      </component>


      <!-- Microsoft Office Word 16 (32-bit) -->
      <component context="UserAndSystem" type="Application">
        <displayName _locID="migapp.office16word32bit">Microsoft Office Word 2016 (32-bit)</displayName>
        <environment>
          <variable name="OFFICEPROGRAM">
            <text>Word</text>
          </variable>
          <variable name="OFFICEVERSION">
            <text>16.0</text>
          </variable>
        </environment>
        <role role="Settings">
          <detection name="Word" />
          <detection name="Word_x64"/>
          <rules>
            <destinationCleanup>
              <objectSet>
                <pattern type="Registry">HKCU\software\Microsoft\Office\16.0\Word\Data\* [*]</pattern>
              </objectSet>
            </destinationCleanup>
            <include>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Word\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Common\Toolbars\Word\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Common\Research\* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Common\General\[SharedDocumentParts]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Common\General\[SharedTemplates]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Common\General\[Templates]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Common\General\[Themes]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\Common\Blog \* [*]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Common\Spotlight\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Templates\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Proof\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\UProof\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\QuickStyles\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Document Building Blocks\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Bibliography\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office\ [Word.qat]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office\ [Word16.customUI]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [Word16.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [WordMa16.pip]</pattern>
              </objectSet>
            </include>
            <merge script="MigXmlHelper.SourcePriority()">
              <objectSet>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Templates\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Proof\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\UProof\* [*]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\QuickStyles\* [*]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office\ [Word.qat]</pattern>
                <pattern type="File">%CSIDL_LOCAL_APPDATA%\Microsoft\Office\ [Word16.customUI]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [Word16.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [WordMa16.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Office\ [WordMa16.pip]</pattern>
                <pattern type="File">%CSIDL_APPDATA%\Microsoft\Document Building Blocks\* [*]</pattern>
              </objectSet>
            </merge>
            <unconditionalExclude>
              <objectSet>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Word\Options\[PROGRAMDIR]</pattern>
                <!-- A user would only set these two setting to mitigate performance issues on an older machine. It's likely that users are upgrading to a more powerful machine, so let the defaults kick back in for these settings -->
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Word\Options\[LiveDrag]</pattern>
                <pattern type="Registry">HKCU\Software\Microsoft\Office\16.0\Word\Options\[LivePreview]</pattern>
                <!-- We can't know if the source \Word\Data\ blobs will be valid on the destination system, so exclude them-->
                <pattern type="Registry">HKCU\software\Microsoft\Office\16.0\Word\Data\* [*]</pattern>
              </objectSet>
            </unconditionalExclude>
          </rules>
          <rules name="Office16to16SettingsMigrate" />
          <rules name="Office16to16SettingsMigrate_x64"/>
        </role>
      </component>

  </role>
  </component>

</migration>
